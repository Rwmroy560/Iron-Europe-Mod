claim = {
  name = CB_NAME_CLAIM
  war_name = WAR_NAME_CLAIM
  sprite = 1
  truce_days = 3650
  hostile_against_others = yes
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  press_claim = yes
  infamy_modifier = 0.85
  sort_priority = 1000
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    OR = {
      ROOT = {
        is_female = no
      }
      AND = {
        NOT = {
          ROOT = {
            religion_group = muslim
          }
        }
        NOT = {
          ROOT = {
            has_religion_feature = religion_patriarchal
          }
        }
      }
    }
    OR = {
      ROOT = {
        is_female = yes
      }
      NOT = {
        ROOT = {
          has_religion_feature = religion_matriarchal
        }
      }
    }
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    ROOT = {
      OR = {
        is_ruler = no
        primary_title = {
          OR = {
            is_primary_type_title = no
            higher_tier_than = PREVPREV
            tier = PREVPREV
          }
        }
      }
    }
    OR = {
      ROOT = {
        has_strong_claim = PREV
      }
      ROOT = {
        has_character_flag = claimant_adventurer
      }
      AND = {
        ROOT = {
          has_weak_claim = PREV
        }
        OR = {
          is_pretender = yes
          holder_scope = {
            has_regent = yes
          }
          AND = {
            ROOT = {
              OR = {
                is_female = no
                has_law = status_of_women_4
                has_religion_feature = religion_matriarchal
                has_religion_feature = religion_equal
                has_religion_feature = religion_feature_bon
              }
            }
            holder_scope = {
              AND = {
                is_female = yes
                NOR = {
                  has_religion_feature = religion_matriarchal
                  has_religion_feature = religion_equal
                  has_religion_feature = religion_feature_bon
                  has_law = status_of_women_4
                  has_game_rule = {
                    name = gender
                    value = all
                  }
                }
              }
            }
          }
          is_contested = yes
        }
      }
    }
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    ROOT = {
      has_claim = PREV
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    hidden_tooltip = {
      ROOT = {
        clr_character_flag = claimant_adventurer
        if = {
          limit = {
            has_nickname = no
            lower_tier_than = PREV
          }
          random = {
            chance = 50
            give_nickname = nick_the_usurper
          }
        }
      }
    }
    usurp_title_plus_barony_if_unlanded = {
      target = ROOT
      type = claim
    }
    if = {
      limit = {
        higher_tier_than = BARON
        NOT = {
          culture = ROOT
        }
      }
      hidden_tooltip = {
        conquest_culture = ROOT
      }
    }
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    FROM = {
      show_scope_change = no
      prestige = -100
    }
    hidden_tooltip = {
      check_war_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail_title = {
    ROOT = {
      show_scope_change = no
      prestige = -100
      hidden_tooltip = {
        disband_event_forces = yes
        clr_character_flag = claimant_adventurer
      }
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -150
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    if = {
      limit = {
        ROOT = {
          has_character_flag = claimant_adventurer
        }
      }
      ROOT = {
        imprison = FROM
      }
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 150
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 150
      }
    }
    hidden_effect = {
      ROOT = {
        if = {
          limit = {
            has_landed_title = e_china_west_governor
          }
          log = "China War Logging: China lost a claim war against [From.GetBestName]"
        }
        if = {
          limit = {
            has_landed_title = e_china_west_governor
            offmap_china = {
              has_policy = china_expansionist
            }
          }
          random = {
            chance = 50
            offmap_china = {
              set_policy = china_open
              log = "-------------------------------------"
              log = "China Policy Logging:"
              log = "Chinas new Policy is now OPEN"
              log = "-------------------------------------"
            }
          }
        }
      }
    }
  }
  on_reverse_demand_title = {
    ROOT = {
      show_scope_change = no
      remove_claim = PREV
    }
    ROOT = {
      hidden_tooltip = {
        disband_event_forces = yes
        clr_character_flag = claimant_adventurer
      }
    }
  }
  on_attacker_leader_death = {
    if = {
      limit = {
        ROOT = {
          has_character_flag = EoD_prophet_attacker
        }
      }
      FROM = {
        narrative_event = {
          id = RIP.15116
        }
      }
    }
    if = {
      limit = {
        ROOT = {
          OR = {
            has_character_flag = claimant_adventurer
            has_character_flag = EoD_prophet_attacker
          }
        }
      }
      ROOT = {
        hidden_tooltip = {
          disband_event_forces = yes
          clr_character_flag = claimant_adventurer
          clr_character_flag = EoD_prophet_attacker
        }
      }
      end_war = invalid
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
other_claim = {
  name = CB_NAME_CLAIM
  war_name = WAR_NAME_OTHER_CLAIM
  sprite = 2
  truce_days = 3650
  hostile_against_others = yes
  can_ask_to_join_war = no
  press_claim = yes
  allowed_to_target_tributaries = no
  infamy_modifier = 0.5
  sort_priority = 900
  can_use = {
    ROOT = {
      mercenary = no
    }
  }
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    OR = {
      ROOT = {
        is_female = no
      }
      AND = {
        NOT = {
          ROOT = {
            religion_group = muslim
          }
        }
        NOT = {
          ROOT = {
            has_religion_feature = religion_patriarchal
          }
        }
        NOT = {
          succ_law_title = {
            has_law = agnatic_succession
          }
        }
      }
    }
    OR = {
      ROOT = {
        is_female = yes
      }
      AND = {
        NOT = {
          ROOT = {
            has_religion_feature = religion_matriarchal
          }
        }
        NOT = {
          succ_law_title = {
            has_law = enatic_succession
          }
        }
      }
    }
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    ROOT = {
      OR = {
        is_ruler = no
        primary_title = {
          OR = {
            is_primary_type_title = no
            higher_tier_than = PREVPREV
            tier = PREVPREV
          }
        }
      }
    }
    NOT = {
      any_war = {
        attacker = {
          character = ROOT
        }
      }
    }
    OR = {
      ROOT = {
        has_strong_claim = PREV
      }
      AND = {
        ROOT = {
          has_weak_claim = PREV
        }
        OR = {
          is_pretender = yes
          holder_scope = {
            has_regent = yes
          }
          AND = {
            ROOT = {
              OR = {
                is_female = no
                has_law = status_of_women_4
              }
            }
            holder_scope = {
              AND = {
                is_female = yes
                NOR = {
                  has_law = status_of_women_4
                  has_game_rule = {
                    name = gender
                    value = all
                  }
                }
              }
            }
          }
          is_contested = yes
        }
      }
    }
    OR = {
      multiplayer = no
      FROMFROM = {
        ai = yes
      }
      has_game_rule = {
        name = multiplayer_third_party_claims
        value = on
      }
      AND = {
        has_game_rule = {
          name = multiplayer_third_party_claims
          value = limited
        }
        lower_tier_than = KING
      }
    }
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    ROOT = {
      has_claim = PREV
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    hidden_tooltip = {
      ROOT = {
        opinion = {
          modifier = pressed_my_claim
          who = PREV
          multiplier = 2
        }
      }
    }
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    FROM = {
      show_scope_change = no
      prestige = -100
    }
  }
  on_success_title = {
    hidden_tooltip = {
      ROOT = {
        if = {
          limit = {
            has_nickname = no
            lower_tier_than = PREV
          }
          random = {
            chance = 50
            give_nickname = nick_the_usurper
          }
        }
      }
      if = {
        limit = {
          OR = {
            title = k_papal_state
            title = d_fraticelli
          }
        }
        FROM = {
          transfer_scaled_wealth = {
            to = ROOT
            value = all
          }
        }
      }
    }
    if = {
      limit = {
        controls_religion = yes
        holder_scope = {
          OR = {
            religion = catholic
            religion = fraticelli
          }
        }
      }
      holder_scope = {
        abdicate_to = ROOT
      }
      if = {
        limit = {
          FROMFROM = {
            higher_tier_than = PREV
          }
        }
        ROOT = {
          set_defacto_liege = FROMFROM
        }
      }
    }
    if = {
      limit = {
        OR = {
          controls_religion = no
          NOT = {
            holder_scope = {
              OR = {
                religion = catholic
                religion = fraticelli
              }
            }
          }
        }
      }
      if = {
        limit = {
          holder_scope = {
            same_realm = FROMFROM
          }
        }
        ROOT = {
          set_character_flag = other_claim_tmp_flag
        }
      }
      if = {
        limit = {
          ROOT = {
            is_ruler = yes
            is_liege_or_above = FROMFROM
          }
        }
        ROOT = {
          set_character_flag = claimant_is_vassal_ruler_flag
        }
      }
      usurp_title_plus_barony_if_unlanded = {
        target = ROOT
        type = claim
      }
      hidden_tooltip = {
        ROOT = {
          any_child = {
            limit = {
              is_ruler = no
              is_married = no
              prisoner = no
              is_adult = no
              is_within_diplo_range = ROOT
            }
            move_character = ROOT
          }
          any_spouse = {
            limit = {
              is_ruler = no
              prisoner = no
              is_within_diplo_range = ROOT
            }
            move_character = ROOT
          }
          any_consort = {
            limit = {
              is_ruler = no
              prisoner = no
              is_within_diplo_range = ROOT
            }
            move_character = ROOT
          }
        }
        if = {
          limit = {
            NOT = {
              ROOT = {
                has_character_flag = claimant_is_vassal_ruler_flag
              }
            }
            holder_scope = {
              is_liege_or_above = FROMFROM
            }
            NOT = {
              de_jure_liege_or_above = FROMFROM
            }
            ROOT = {
              NOT = {
                dynasty = FROMFROM
              }
            }
          }
          ROOT = {
            set_defacto_liege = ROOT
          }
        }
        if = {
          limit = {
            holder_scope = {
              NOR = {
                is_liege_or_above = FROMFROM
                character = FROMFROM
              }
            }
            OR = {
              holder_scope = {
                de_jure_liege_or_above = FROMFROM
              }
              ROOT = {
                has_character_flag = claimant_is_vassal_ruler_flag
              }
              ROOT = {
                dynasty = FROMFROM
              }
            }
          }
          ROOT = {
            set_defacto_liege = FROMFROM
          }
        }
        if = {
          limit = {
            NOT = {
              ROOT = {
                has_character_flag = other_claim_tmp_flag
              }
            }
            FROM = {
              FROM = {
                top_liege = {
                  ROOT = {
                    top_liege = {
                      NOT = {
                        character = PREVPREV
                      }
                    }
                  }
                }
              }
            }
          }
          ROOT = {
            set_defacto_liege = ROOT
          }
        }
        if = {
          limit = {
            ROOT = {
              has_character_flag = other_claim_tmp_flag
              de_facto_liege = ROOT
            }
          }
          FROM = {
            FROM = {
              top_liege = {
                ROOT = {
                  set_defacto_liege = PREV
                }
              }
            }
          }
        }
        ROOT = {
          clr_character_flag = other_claim_tmp_flag
          clr_character_flag = claimant_is_vassal_ruler_flag
        }
      }
    }
    if = {
      limit = {
        higher_tier_than = BARON
        NOT = {
          culture = ROOT
        }
      }
      hidden_tooltip = {
        conquest_culture = ROOT
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail_title = {
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
    FROM = {
      show_scope_change = no
      FROM = {
        show_scope_change = no
        prestige = -100
      }
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  on_reverse_demand = {
    prestige = -150
    transfer_scaled_wealth = {
      to = FROM
      value = 4.0
    }
    ROOT = {
      show_scope_change = no
      prestige = -150
      imprison = FROM
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 150
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 150
      }
    }
  }
  on_reverse_demand_title = {
    ROOT = {
      show_scope_change = no
      remove_claim = PREV
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
claim_on_liege = {
  name = CB_NAME_CLAIM
  war_name = WAR_NAME_CLAIM_LIEGE
  sprite = 3
  truce_days = 3650
  hostile_against_others = yes
  press_claim = yes
  can_call_vassals = no
  major_revolt = yes
  allowed_to_target_tributaries = no
  infamy_modifier = 0.85
  sort_priority = 910
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    OR = {
      ROOT = {
        has_strong_claim = PREV
      }
      ROOT = {
        has_character_flag = faction_claimant_ultimatum_taken
      }
      AND = {
        ROOT = {
          has_weak_claim = PREV
        }
        OR = {
          is_pretender = yes
          holder_scope = {
            has_regent = yes
          }
          AND = {
            ROOT = {
              OR = {
                is_female = no
                has_law = status_of_women_4
              }
            }
            holder_scope = {
              AND = {
                is_female = yes
                NOR = {
                  has_law = status_of_women_4
                  has_game_rule = {
                    name = gender
                    value = all
                  }
                }
              }
            }
          }
          is_contested = yes
        }
      }
    }
    is_vice_royalty = no
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  is_valid_title = {
    NOT = {
      holder_scope = {
        character = ROOT
      }
    }
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    OR = {
      has_law = succ_feudal_elective
      has_law = succ_hre_elective
      ROOT = {
        has_claim = PREV
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
    if = {
      limit = {
        ROOT = {
          prisoner = yes
          host = {
            character = FROM
          }
        }
      }
      ROOT = {
        prisoner = no
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        is_primary_holder_title = yes
      }
      FROM = {
        imprison = ROOT
      }
    }
    usurp_title_plus_barony_if_unlanded_and_vassals_no_adj = {
      target = ROOT
      type = claim
    }
    if = {
      limit = {
        higher_tier_than = BARON
        NOT = {
          culture = ROOT
        }
      }
      hidden_tooltip = {
        conquest_culture = ROOT
      }
    }
    if = {
      limit = {
        higher_tier_than = FROM
      }
      FROM = {
        set_defacto_liege = ROOT
      }
    }
    hidden_tooltip = {
      ROOT = {
        if = {
          limit = {
            has_nickname = no
            PREV = {
              higher_tier_than = count
            }
          }
          random = {
            chance = 50
            give_nickname = nick_the_usurper
          }
        }
      }
    }
    hidden_tooltip = {
      check_war_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -150
    }
    FROM = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        disband_event_forces = faction_revolters
        prisoner = FROM
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_attacker_leader_death = {
    hidden_tooltip = {
      any_defender = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
claim_on_liege_plot = {
  name = CB_NAME_CLAIM
  war_name = WAR_NAME_CLAIM_LIEGE
  sprite = 3
  truce_days = 3650
  hostile_against_others = yes
  press_claim = yes
  major_revolt = yes
  attacker_can_call_allies = no
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  infamy_modifier = 0.85
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
  }
  on_success_title = {
    usurp_title_plus_barony_if_unlanded = {
      target = ROOT
      type = claim
    }
    if = {
      limit = {
        higher_tier_than = BARON
        NOT = {
          culture = ROOT
        }
      }
      hidden_tooltip = {
        conquest_culture = ROOT
      }
    }
    ROOT = {
      plot_succeeds = yes
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
    hidden_tooltip = {
      check_war_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      imprison = FROM
    }
    FROM = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_attacker_leader_death = {
    hidden_tooltip = {
      any_defender = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
claim_on_vassal_plot = {
  name = CB_NAME_CLAIM_VASSAL
  war_name = WAR_NAME_CLAIM_VASSAL
  sprite = 3
  truce_days = 3650
  hostile_against_others = yes
  reflect_titleholder_change = no
  press_claim = yes
  attacker_can_call_allies = no
  can_attack_vassals = yes
  allowed_to_target_tributaries = no
  infamy_modifier = 0.85
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        de_facto_liege = ROOT
      }
    }
  }
  is_valid_title = {
    FROM = {
      has_landed_title = PREV
    }
    ROOT = {
      has_plot = plot_gain_vassal_title
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 50
    }
  }
  on_success_title = {
    usurp_title_plus_barony_if_unlanded = {
      target = ROOT
      type = claim
    }
    ROOT = {
      plot_succeeds = yes
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
      cancel_plot = plot_gain_vassal_title
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_invalidation = {
    ROOT = {
      cancel_plot = plot_gain_vassal_title
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      cancel_plot = plot_gain_vassal_title
    }
    FROM = {
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  on_attacker_leader_death = {
    hidden_tooltip = {
      any_defender = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  on_defender_leader_death = {
    ROOT = {
      cancel_plot = plot_gain_vassal_title
    }
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
other_claim_on_liege = {
  name = CB_NAME_CLAIM
  war_name = WAR_NAME_OTHER_CLAIM
  sprite = 4
  truce_days = 3650
  hostile_against_others = yes
  can_ask_to_join_war = no
  press_claim = yes
  can_call_vassals = no
  major_revolt = yes
  allowed_to_target_tributaries = no
  infamy_modifier = 0.5
  sort_priority = 850
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    OR = {
      ROOT = {
        is_female = no
      }
      NOT = {
        has_law = agnatic_succession
      }
      AND = {
        lower_tier_than = KING
        is_primary_holder_title = no
      }
      FROMFROM = {
        has_character_flag = faction_claimant_ultimatum_taken
      }
    }
    FROM = {
      has_landed_title = PREV
    }
    OR = {
      ROOT = {
        has_strong_claim = PREV
      }
      FROMFROM = {
        has_character_flag = faction_claimant_ultimatum_taken
      }
      AND = {
        ROOT = {
          has_weak_claim = PREV
        }
        OR = {
          is_pretender = yes
          holder_scope = {
            has_regent = yes
          }
          AND = {
            ROOT = {
              OR = {
                is_female = no
                has_law = status_of_women_4
              }
            }
            holder_scope = {
              AND = {
                is_female = yes
                NOR = {
                  has_law = status_of_women_4
                  has_game_rule = {
                    name = gender
                    value = all
                  }
                }
              }
            }
          }
          is_contested = yes
        }
      }
    }
    is_vice_royalty = no
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    OR = {
      liege = {
        character = PREV
      }
      liege = {
        FROM = {
          is_liege_or_above = PREV
        }
      }
    }
  }
  is_valid_title = {
    NOT = {
      holder_scope = {
        character = ROOT
      }
    }
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    OR = {
      has_law = succ_feudal_elective
      has_law = succ_hre_elective
      ROOT = {
        has_claim = PREV
      }
    }
    NOT = {
      any_war = {
        attacker = {
          character = ROOT
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    participation_scaled_prestige = 100
    hidden_tooltip = {
      disband_event_forces = faction_revolters
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
        NOT = {
          character = PREV
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        disband_event_forces = faction_revolters
      }
    }
    ROOT = {
      opinion = {
        modifier = pressed_my_claim
        who = PREV
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
    if = {
      limit = {
        ROOT = {
          prisoner = yes
          host = {
            character = FROM
          }
        }
      }
      ROOT = {
        prisoner = no
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        is_primary_holder_title = yes
      }
      hidden_tooltip = {
        FROM = {
          set_character_flag = temp_other_claim_on_liege_prison
        }
      }
    }
    hidden_tooltip = {
      ROOT = {
        if = {
          limit = {
            has_nickname = no
            lower_tier_than = PREV
          }
          random = {
            chance = 50
            give_nickname = nick_the_usurper
          }
        }
      }
    }
    if = {
      limit = {
        higher_tier_than = ROOT
        holder_scope = {
          is_feudal = yes
        }
        ROOT = {
          is_ruler = yes
          OR = {
            is_theocracy = yes
            is_republic = yes
          }
        }
      }
      ROOT = {
        abdicate = {
          move = no
        }
      }
    }
    usurp_title_plus_barony_if_unlanded_and_vassals_no_adj = {
      target = ROOT
      type = claim
    }
    if = {
      limit = {
        higher_tier_than = BARON
        NOT = {
          culture = ROOT
        }
      }
      hidden_tooltip = {
        conquest_culture = ROOT
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_success_posttitle = {
    hidden_tooltip = {
      if = {
        limit = {
          top_liege = {
            ROOT = {
              NOT = {
                top_liege = {
                  character = PREVPREV
                }
              }
            }
          }
        }
        ROOT = {
          set_defacto_liege = PREV
        }
      }
      if = {
        limit = {
          top_liege = {
            ROOT = {
              NOT = {
                top_liege = {
                  character = PREVPREV
                }
              }
            }
          }
        }
        ROOT = {
          set_defacto_liege = ROOT
        }
      }
      if = {
        limit = {
          FROM = {
            has_character_flag = temp_other_claim_on_liege_prison
            lower_tier_than = PREV
          }
        }
        FROM = {
          imprison = ROOT
        }
      }
      FROM = {
        clr_character_flag = temp_other_claim_on_liege_prison
      }
    }
  }
  on_fail = {
    prestige = -100
    imprison = FROM
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_reverse_demand = {
    prestige = -200
    imprison = FROM
    FROM = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        disband_event_forces = faction_revolters
        prisoner = FROM
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
claim_all = {
  name = CB_NAME_CLAIM_ALL
  war_name = WAR_NAME_CLAIM_ALL
  sprite = 5
  truce_days = 3650
  is_permanent = yes
  can_ask_to_join_war = no
  is_claim_all = yes
  allowed_to_target_tributaries = no
  sort_priority = 1100
  can_use = {
    ROOT = {
      total_claims = {
        who = FROM
        strong = yes
        value = 2
      }
    }
  }
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  is_valid = {
    ROOT = {
      total_claims = {
        who = FROM
        strong = yes
        value = 1
      }
    }
  }
  on_add = {
    ROOT = {
      show_scope_change = no
      any_claim = {
        show_scope_change = no
        limit = {
          holder_scope = {
            OR = {
              character = FROM
              is_liege_or_above = FROM
            }
          }
          ROOT = {
            has_strong_claim = PREV
          }
        }
        press_claim = ROOT
      }
    }
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      show_scope_change = no
      any_claim = {
        show_scope_change = no
        limit = {
          holder_scope = {
            OR = {
              character = FROM
              is_liege_or_above = FROM
            }
          }
          ROOT = {
            has_strong_claim = PREV
          }
        }
        usurp_title_plus_barony_if_unlanded = {
          target = ROOT
          type = claim
        }
        if = {
          limit = {
            higher_tier_than = BARON
            NOT = {
              culture = ROOT
            }
          }
          hidden_tooltip = {
            conquest_culture = ROOT
          }
        }
      }
      if = {
        limit = {
          is_offmap_governor = yes
          offmap_power = {
            is_offmap_tag = offmap_china
          }
          offmap_china = {
            has_offmap_tmp_flag = WP_is_not_on_map
          }
          NOT = {
            wealth = 2500
          }
        }
        set_variable = {
          which = WP_nomad_provinces
          value = 0
        }
        any_realm_province = {
          limit = {
            has_province_modifier = nomad_agitation
            NOT = {
              has_settlement_construction = yes
            }
          }
          province_event = {
            id = JD.60100
          }
        }
        character_event = {
          id = JD.60101
          days = 1
        }
      }
    }
    hidden_tooltip = {
      ROOT = {
        if = {
          limit = {
            has_dlc = "Legacy of Rome"
            OR = {
              has_landed_title = e_byzantium
              has_landed_title = e_roman_empire
            }
            OR = {
              religion_group = christian
              religion = hellenic_pagan
              religion = hellenic_pagan_reformed
            }
          }
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
    }
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
      if = {
        limit = {
          has_character_flag = is_otto
          FROM = {
            has_character_flag = is_giselbert
          }
        }
        reverse_imprison = FROM
      }
    }
  }
  on_fail = {
    ROOT = {
      show_scope_change = no
      prestige = -150
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 75
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 75
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
      any_claim = {
        show_scope_change = no
        limit = {
          holder_scope = {
            OR = {
              character = FROM
              is_liege_or_above = FROM
            }
          }
          ROOT = {
            has_strong_claim = PREV
          }
        }
        ROOT = {
          show_scope_change = no
          remove_claim = PREV
        }
      }
      hidden_effect = {
        if = {
          limit = {
            has_landed_title = e_china_west_governor
            offmap_china = {
              has_policy = china_expansionist
            }
          }
          random = {
            chance = 50
            offmap_china = {
              set_policy = china_open
              log = "-------------------------------------"
              log = "China Policy Logging:"
              log = "Chinas new Policy is now OPEN"
              log = "-------------------------------------"
            }
          }
          log = "China War Logging: China lost a claim all war against [From.GetBestName]"
        }
      }
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 200
      if = {
        limit = {
          has_dlc = "Legacy of Rome"
          OR = {
            has_landed_title = e_byzantium
            has_landed_title = e_roman_empire
          }
          OR = {
            religion_group = christian
            religion = hellenic_pagan
            religion = hellenic_pagan_reformed
          }
        }
        hidden_tooltip = {
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
change_seniority_succession_law = {
  name = CB_NAME_SENIORITY_SUCCESSION_LAW
  war_name = WAR_NAME_SENIORITY_SUCCESSION_LAW
  sprite = 6
  truce_days = 3650
  attacker_can_call_allies = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_use = {
    ROOT = {
      vassal_of = FROM
    }
  }
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  is_valid_title = {
    NOT = {
      has_law = succ_seniority
    }
    OR = {
      tier = emperor
      tier = king
      is_primary_holder_title = yes
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
    ROOT = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        disband_event_forces = faction_revolters
      }
    }
  }
  on_success_title = {
    succession_w_cooldown = seniority
  }
  on_fail = {
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_succ_seniority_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_succ_seniority_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
change_primogeniture_succession_law = {
  name = CB_NAME_PRIMOGENITURE_SUCCESSION_LAW
  war_name = WAR_NAME_PRIOGENITURE_SUCCESSION_LAW
  sprite = 6
  truce_days = 3650
  attacker_can_call_allies = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_use = {
    ROOT = {
      vassal_of = FROM
    }
  }
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  is_valid_title = {
    NOT = {
      has_law = succ_primogeniture
    }
    OR = {
      tier = emperor
      tier = king
      is_primary_holder_title = yes
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        disband_event_forces = faction_revolters
      }
    }
  }
  on_success_title = {
    succession_w_cooldown = primogeniture
  }
  on_fail = {
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_succ_primogeniture_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_succ_primogeniture_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
change_feudal_elective_succession_law = {
  name = CB_NAME_FEUDAL_ELECTIVE_SUCCESSION_LAW
  war_name = WAR_NAME_FEUDAL_ELECTIVE_SUCCESSION_LAW
  sprite = 6
  truce_days = 3650
  attacker_can_call_allies = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_use = {
    ROOT = {
      vassal_of = FROM
    }
  }
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  is_valid_title = {
    NOR = {
      has_law = succ_feudal_elective
      has_law = succ_hre_elective
    }
    OR = {
      tier = emperor
      tier = king
      is_primary_holder_title = yes
    }
  }
  on_success = {
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        disband_event_forces = faction_revolters
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        NOR = {
          title = e_hre
          has_title_flag = alternate_hre
        }
      }
      add_law_w_cooldown = succ_feudal_elective
    }
    if = {
      limit = {
        OR = {
          title = e_hre
          has_title_flag = alternate_hre
        }
      }
      add_law_w_cooldown = succ_hre_elective
    }
  }
  on_fail = {
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_succ_feudal_elective_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_succ_feudal_elective_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
invasion = {
  name = CB_NAME_INVASION
  war_name = WAR_NAME_INVASION
  sprite = 7
  truce_days = 3650
  hostile_against_others = yes
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  sort_priority = 2000
  can_use = {
    ROOT = {
      mercenary = no
    }
  }
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      show_scope_change = no
      prestige = 200
    }
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 200
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
      }
    }
    hidden_tooltip = {
      FROM = {
        any_vassal = {
          set_character_flag = preserve_vassal_structure_@ROOT
        }
      }
      ROOT = {
        occupy_minors_of_occupied_settlements = FROM
        gain_all_occupied_titles = FROM
        if = {
          limit = {
            has_nickname = no
          }
          random_list = {
            10 = {
              give_nickname = nick_the_great
            }
            10 = {
              give_nickname = nick_the_victorious
            }
            10 = {
              give_nickname = nick_the_bold
            }
            10 = {
              give_nickname = nick_the_conqueror
            }
          }
        }
        if = {
          limit = {
            has_nickname = nick_the_bastard
          }
          give_nickname = nick_the_conqueror
        }
        if = {
          limit = {
            has_dlc = "Legacy of Rome"
            OR = {
              has_landed_title = e_byzantium
              has_landed_title = e_roman_empire
            }
            OR = {
              religion_group = christian
              religion = hellenic_pagan
              religion = hellenic_pagan_reformed
            }
          }
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
    }
    FROM = {
      show_scope_change = no
      prestige = -200
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = invasion_succ_tip
      hidden_tooltip = {
        usurp_title_plus_barony_if_unlanded = {
          target = ROOT
          type = invasion
        }
        FROM = {
          set_defacto_liege = ROOT
        }
        if = {
          limit = {
            FROM = {
              is_liege_or_above = ROOT
            }
          }
          FROM = {
            imprison = ROOT
          }
        }
        if = {
          limit = {
            any_independent_ruler = {
              has_character_flag = preserve_vassal_structure_@ROOT
            }
          }
          any_independent_ruler = {
            limit = {
              has_character_flag = preserve_vassal_structure_@ROOT
            }
            set_defacto_liege = ROOT
          }
        }
        ROOT = {
          any_vassal = {
            clr_character_flag = preserve_vassal_structure_@ROOT
          }
        }
      }
    }
    if = {
      limit = {
        higher_tier_than = BARON
        NOT = {
          culture = ROOT
        }
      }
      hidden_tooltip = {
        conquest_culture = ROOT
      }
    }
    if = {
      limit = {
        ROOT = {
          character = 140
        }
      }
      ROOT = {
        if = {
          limit = {
            has_dlc = "Holy Fury"
            NOT = {
              any_owned_bloodline = {
                has_bloodline_flag = william_the_conqueror_bloodline
              }
            }
          }
          create_bloodline = {
            type = william_the_conqueror
          }
        }
      }
      hidden_tooltip = {
        add_law = succ_primogeniture
        ROOT = {
          any_vassal = {
            limit = {
              culture = saxon
            }
            opinion = {
              modifier = opinion_subjugated
              who = ROOT
            }
          }
          if = {
            limit = {
              ai = yes
            }
            d_bedford = {
              usurp_title_plus_barony_if_unlanded = {
                target = ROOT
                type = invasion
              }
              any_de_jure_vassal_title = {
                limit = {
                  holder_scope = {
                    culture = saxon
                    ai = yes
                    same_realm = ROOT
                  }
                }
                usurp_title_plus_barony_if_unlanded = {
                  target = ROOT
                  type = invasion
                }
              }
            }
            d_canterbury = {
              usurp_title_plus_barony_if_unlanded = {
                target = ROOT
                type = invasion
              }
              any_de_jure_vassal_title = {
                limit = {
                  holder_scope = {
                    culture = saxon
                    ai = yes
                    same_realm = ROOT
                  }
                }
                usurp_title_plus_barony_if_unlanded = {
                  target = ROOT
                  type = invasion
                }
              }
            }
            d_cornwall = {
              usurp_title_plus_barony_if_unlanded = {
                target = ROOT
                type = invasion
              }
              any_de_jure_vassal_title = {
                limit = {
                  holder_scope = {
                    culture = saxon
                    ai = yes
                    same_realm = ROOT
                  }
                }
                usurp_title_plus_barony_if_unlanded = {
                  target = ROOT
                  type = invasion
                }
              }
            }
            d_somerset = {
              usurp_title_plus_barony_if_unlanded = {
                target = ROOT
                type = invasion
              }
              any_de_jure_vassal_title = {
                limit = {
                  holder_scope = {
                    culture = saxon
                    ai = yes
                    same_realm = ROOT
                  }
                }
                usurp_title_plus_barony_if_unlanded = {
                  target = ROOT
                  type = invasion
                }
              }
            }
            d_gloucester = {
              usurp_title_plus_barony_if_unlanded = {
                target = ROOT
                type = invasion
              }
              any_de_jure_vassal_title = {
                limit = {
                  holder_scope = {
                    culture = saxon
                    ai = yes
                    same_realm = ROOT
                  }
                }
                usurp_title_plus_barony_if_unlanded = {
                  target = ROOT
                  type = invasion
                }
              }
            }
            d_norfolk = {
              usurp_title_plus_barony_if_unlanded = {
                target = ROOT
                type = invasion
              }
              any_de_jure_vassal_title = {
                limit = {
                  holder_scope = {
                    culture = saxon
                    ai = yes
                    same_realm = ROOT
                  }
                }
                usurp_title_plus_barony_if_unlanded = {
                  target = ROOT
                  type = invasion
                }
              }
            }
          }
          if = {
            limit = {
              c_middlesex = {
                holder_scope = {
                  character = ROOT
                }
              }
            }
            c_middlesex = {
              capital_holding = {
                ROOT = {
                  capital = PREV
                }
              }
            }
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      show_scope_change = no
      prestige = -200
    }
    FROM = {
      show_scope_change = no
      prestige = 100
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 8.0
      }
    }
    FROM = {
      show_scope_change = no
      prestige = 200
      participation_scaled_prestige = 200
      if = {
        limit = {
          has_dlc = "Legacy of Rome"
          OR = {
            has_landed_title = e_byzantium
            has_landed_title = e_roman_empire
          }
          OR = {
            religion_group = christian
            religion = hellenic_pagan
            religion = hellenic_pagan_reformed
          }
        }
        hidden_tooltip = {
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
      }
    }
  }
  on_reverse_demand_title = {
    ROOT = {
      show_scope_change = no
      remove_claim = PREV
    }
  }
  on_attacker_leader_death = {
    hidden_tooltip = {
      any_defender = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = whitepeace
  }
  attacker_ai_victory_worth = {
    factor = 150
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_nomadic = no
        NOT = {
          is_tribal = yes
        }
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_tribal = yes
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
              holding_type = tribal
            }
          }
        }
      }
    }
  }
}
tribal_invasion = {
  name = CB_NAME_INVASION
  war_name = WAR_NAME_INVASION
  sprite = 8
  truce_days = 3650
  hostile_against_others = yes
  is_permanent = yes
  can_ask_to_join_war = yes
  check_de_jure_tier = KING
  allowed_to_target_tributaries = no
  sort_priority = 2000
  can_use_gui = {
    ROOT = {
      prestige = 500
    }
    check_if_crusader_trigger = yes
  }
  on_add = {
    ROOT = {
      show_scope_change = no
      prestige = -500
    }
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
    if = {
      limit = {
        attacker = {
          any_owned_bloodline = {
            has_bloodline_flag = bloodline_great_conquerors
          }
        }
      }
      attacker = {
        set_character_flag = flag_declared_bloodline_invasion
      }
    }
  }
  can_use_title = {
    OR = {
      ROOT = {
        has_landed_title = e_brazil
      }
      ROOT = {
        has_landed_title = e_canada
      }
      ROOT = {
        has_landed_title = e_united_states
      }
      ROOT = {
        OR = {
          ai = yes
          multiplayer = no
          NOT = {
            has_game_rule = {
              name = multiplayer_invasions
              value = off
            }
          }
        }
        is_nomadic = no
        OR = {
          AND = {
            has_dlc = "Horse Lords"
            higher_tier_than = COUNT
            OR = {
              has_character_flag = horde_invader
              AND = {
                independent = yes
                religion_group = pagan_group
                OR = {
                  culture_group = altaic
                  culture_group = magyar
                  culture_group = mesoamerican
                }
                FROM = {
                  NOT = {
                    religion_group = pagan_group
                  }
                }
                OR = {
                  is_tribal = yes
                  primary_title = {
                    has_law = succ_elective_gavelkind
                  }
                  has_landed_title = e_mongol_empire
                  has_landed_title = e_mexikha
                }
              }
            }
          }
          AND = {
            NOT = {
              has_dlc = "Horse Lords"
            }
            independent = yes
            higher_tier_than = COUNT
            OR = {
              religion_group = pagan_group
              AND = {
                OR = {
                  has_horde_culture = yes
                  has_character_flag = horde_invader
                }
                NOT = {
                  religion_group = christian
                }
              }
            }
            OR = {
              culture_group = altaic
              culture_group = magyar
              culture_group = mesoamerican
            }
            OR = {
              has_horde_culture = yes
              has_character_flag = horde_invader
              FROM = {
                NOT = {
                  religion_group = pagan_group
                }
              }
            }
            OR = {
              has_character_flag = horde_invader
              is_tribal = yes
              primary_title = {
                has_law = succ_elective_gavelkind
              }
            }
          }
          AND = {
            mercenary = yes
            NOT = {
              num_of_titles = 2
            }
          }
          AND = {
            has_character_flag = is_child_of_destiny
            any_owned_bloodline = {
              has_bloodline_flag = founder_invasions
            }
          }
          AND = {
            NOT = {
              has_character_flag = flag_declared_bloodline_invasion
            }
            any_owned_bloodline = {
              has_bloodline_flag = bloodline_great_conquerors
            }
          }
        }
      }
    }
    ROOT = {
      NOT = {
        same_realm = FROM
      }
    }
  }
  is_valid_title = {
    FROM = {
      any_realm_province = {
        de_jure_liege_or_above = PREVPREV
      }
    }
  }
  on_success = {
    ROOT = {
      show_scope_change = no
      prestige = 200
      participation_scaled_prestige = 200
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
      }
    }
    FROM = {
      show_scope_change = no
      prestige = -200
    }
    hidden_tooltip = {
      ROOT = {
        occupy_minors_of_occupied_settlements = FROM
        gain_all_occupied_titles = {
          who = FROM
          type = invasion
        }
        if = {
          limit = {
            has_nickname = no
          }
          random_list = {
            10 = {
              give_nickname = nick_the_great
            }
            10 = {
              give_nickname = nick_the_victorious
            }
            10 = {
              give_nickname = nick_the_conqueror
            }
            10 = {
              give_nickname = nick_the_brave
            }
            10 = {
              give_nickname = nick_the_dragon
            }
            10 = {
              give_nickname = nick_the_terrible
            }
          }
        }
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        ROOT = {
          OR = {
            character = 159136
            character = 159137
          }
        }
      }
      ROOT = {
        if = {
          limit = {
            has_dlc = "Holy Fury"
            NOT = {
              any_owned_bloodline = {
                has_bloodline_flag = arpad_bloodline
              }
            }
          }
          create_bloodline = {
            type = arpad
          }
        }
      }
    }
    custom_tooltip = {
      text = tribal_invasion_succ_tip
      hidden_tooltip = {
        ROOT = {
          vassalize_or_take_under_title_destroy_duchies = {
            title = PREV
            enemy = FROM
            is_crusade = yes
            type = invasion
          }
        }
        if = {
          limit = {
            e_mexikha = {
              holder = ROOT
            }
          }
          ROOT = {
            any_realm_province = {
              limit = {
                OR = {
                  has_province_flag = aztec_explorers
                  has_province_flag = aztec_second_wave
                }
              }
              culture = nahuatl
              religion = aztec
              clr_province_flag = aztec_explorers
              clr_province_flag = aztec_second_wave
            }
          }
        }
        if = {
          limit = {
            e_canada = {
              holder = ROOT
            }
          }
          ROOT = {
            any_realm_province = {
              limit = {
                OR = {
                  has_province_flag = canadian_explorers
                  has_province_flag = canadian_second_wave
                }
              }
              culture = canadian
              religion = protestant
              clr_province_flag = canadian_explorers
              clr_province_flag = canadian_second_wave
            }
          }
        }
        if = {
          limit = {
            e_united_states = {
              holder = ROOT
            }
          }
          ROOT = {
            any_realm_province = {
              limit = {
                OR = {
                  has_province_flag = american_explorers
                  has_province_flag = american_second_wave
                }
              }
              culture = american
              religion = protestant
              clr_province_flag = american_explorers
              clr_province_flag = american_second_wave
            }
          }
        }
        if = {
          limit = {
            e_brazil = {
              holder = ROOT
            }
          }
          ROOT = {
            any_realm_province = {
              limit = {
                OR = {
                  has_province_flag = brazilian_explorers
                  has_province_flag = brazilian_second_wave
                }
              }
              culture = brazilian
              religion = catholic
              clr_province_flag = brazilian_explorers
              clr_province_flag = brazilian_second_wave
            }
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    FROM = {
      show_scope_change = no
      prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            has_nickname = no
          }
          random_list = {
            10 = {
              give_nickname = nick_the_great
            }
            10 = {
              give_nickname = nick_the_hammer
            }
            10 = {
              give_nickname = nick_the_avenger
            }
            10 = {
              give_nickname = nick_the_lion
            }
            10 = {
              give_nickname = nick_the_bold
            }
          }
        }
      }
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    ROOT = {
      show_scope_change = no
      prestige = -200
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      show_scope_change = no
      prestige = 200
      hidden_tooltip = {
        if = {
          limit = {
            has_nickname = no
          }
          random_list = {
            10 = {
              give_nickname = nick_the_great
            }
            10 = {
              give_nickname = nick_the_hammer
            }
            10 = {
              give_nickname = nick_the_avenger
            }
            10 = {
              give_nickname = nick_the_lion
            }
            10 = {
              give_nickname = nick_the_bold
            }
          }
        }
      }
      if = {
        limit = {
          has_dlc = "Legacy of Rome"
          OR = {
            has_landed_title = e_byzantium
            has_landed_title = e_roman_empire
          }
          OR = {
            religion_group = christian
            religion = hellenic_pagan
            religion = hellenic_pagan_reformed
          }
        }
        hidden_tooltip = {
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
      participation_scaled_prestige = 200
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = 200
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.9
    }
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
    modifier = {
      factor = 0.1
      ROOT = {
        OR = {
          dynasty = 613
          dynasty = 800
          primary_title = {
            title = "e_il-khanate"
          }
        }
      }
      OR = {
        empire = {
          NOT = {
            OR = {
              title = e_persia
              title = e_byzantium
              title = e_arabia
            }
          }
        }
        FROM = {
          primary_title = {
            title = e_golden_horde
          }
          NOT = {
            year = 1300
          }
        }
      }
    }
    modifier = {
      factor = 0.1
      ROOT = {
        primary_title = {
          title = e_golden_horde
        }
      }
      OR = {
        empire = {
          OR = {
            title = e_persia
            title = e_byzantium
            title = e_arabia
          }
        }
        FROM = {
          primary_title = {
            title = "e_il-khanate"
          }
          NOT = {
            year = 1300
          }
        }
      }
    }
    modifier = {
      factor = 0.1
      ROOT = {
        culture = hungarian
        primary_title = {
          OR = {
            title = k_hungary
            title = e_carpathia
          }
        }
      }
      empire = {
        OR = {
          title = e_tartaria
          title = e_russia
        }
      }
    }
    modifier = {
      factor = 0
      ROOT = {
        has_character_flag = is_temujin
        has_landed_title = e_mongol_empire
        demesne_size = 1
      }
      FROM = {
        has_landed_title = e_china_west_governor
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_nomadic = no
        NOT = {
          is_tribal = yes
        }
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_tribal = yes
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
              holding_type = tribal
            }
          }
        }
      }
    }
  }
}

bid_for_independence = {
  name = CB_NAME_INDEPENDENCE
  war_name = WAR_NAME_INDEPENDENCE
  sprite = 12
  truce_days = 3650
  is_permanent = yes
  is_independence = yes
  sort_priority = 1500
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      de_facto_liege = FROM
      higher_tier_than = BARON
      OR = {
        ai = yes
        is_feudal = yes
        is_tribal = yes
        higher_tier_than = COUNT
      }
      mercenary = no
      OR = {
        is_nomadic = no
        NOT = {
          clan_opinion = {
            who = FROM
            value = 0
          }
        }
      }
    }
    FROM = {
      NOT = {
        any_war = {
          attacker = {
            character = PREVPREV
          }
          OR = {
            using_cb = bid_for_independence
            using_cb = depose_liege
          }
        }
      }
      any_demesne_title = {
        NOT = {
          lower_tier_than = ROOT
        }
        temporary = no
      }
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
      NOT = {
        AND = {
          is_merchant_republic = yes
          liege = {
            is_merchant_republic = yes
          }
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
    FROM = {
      any_demesne_title = {
        NOT = {
          lower_tier_than = ROOT
        }
        temporary = no
      }
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
      NOT = {
        AND = {
          is_merchant_republic = yes
          liege_before_war = {
            is_merchant_republic = yes
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    if = {
      limit = {
        FROM = {
          independent = no
        }
      }
      FROM = {
        if = {
          limit = {
            in_revolt = yes
          }
          liege_before_war = {
            ROOT = {
              set_defacto_liege = PREV
            }
          }
        }
        if = {
          limit = {
            in_revolt = no
          }
          liege = {
            ROOT = {
              set_defacto_liege = PREV
            }
          }
        }
      }
    }
    if = {
      limit = {
        FROM = {
          independent = yes
        }
      }
      ROOT = {
        set_defacto_liege = ROOT
      }
    }
    hidden_tooltip = {
      ROOT = {
        prestige = 100
        any_demesne_title = {
          add_pressed_claim = FROM
        }
        set_character_flag = ai_flag_never_transfer
      }
    }
    ROOT = {
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    FROM = {
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -50
      participation_scaled_prestige = -50
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = -50
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -100
      prisoner = FROM
      participation_scaled_prestige = -100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = -100
      }
    }
    FROM = {
      prestige = 50
    }
  }
  on_attacker_leader_death = {
    hidden_tooltip = {
      any_defender = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 150
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
depose_liege = {
  name = CB_NAME_DEPOSE_LIEGE
  war_name = WAR_NAME_DEPOSE_LIEGE
  sprite = 12
  truce_days = 3650
  is_permanent = yes
  can_call_vassals = no
  major_revolt = no
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    always = no
    ROOT = {
      de_facto_liege = FROM
    }
    FROM = {
      is_feudal = yes
      primary_title = {
        is_vice_royalty = no
      }
      NOT = {
        any_war = {
          OR = {
            AND = {
              attacker = {
                character = PREVPREV
              }
              OR = {
                using_cb = bid_for_independence
                using_cb = depose_liege
              }
            }
            AND = {
              defender = {
                character = PREVPREV
              }
              using_cb = depose_liege
            }
          }
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
    FROM = {
      any_demesne_title = {
        NOT = {
          lower_tier_than = ROOT
        }
        temporary = no
      }
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    FROM = {
      prestige = -500
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
      abdicate_to_most_liked_by = ROOT
    }
    ROOT = {
      participation_scaled_prestige = 250
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 250
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      participation_scaled_prestige = 50
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 150
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
overthrow_ruler = {
  name = CB_NAME_OVERTHROWRULER
  war_name = WAR_NAME_OVERTHROWRULER
  sprite = 12
  truce_days = 3650
  is_revolt_cb = yes
  can_call_vassals = yes
  attacker_can_call_allies = no
  major_revolt = yes
  is_tyranny_cb = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    FROM = {
      primary_title = {
        is_vice_royalty = no
      }
    }
    ROOT = {
      de_facto_liege = FROM
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
    FROM = {
      any_demesne_title = {
        NOT = {
          lower_tier_than = ROOT
        }
        temporary = no
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      primary_title = {
        add_pressed_claim = FROM
      }
    }
    FROM = {
      prestige = -500
      remove_opinion = {
        who = ROOT
        modifier = declared_war
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_2
          }
        }
      }
      if = {
        limit = {
          has_dlc = Zeus
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = duke
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = revoke_title_law_0
            }
          }
          if = {
            limit = {
              has_law = revoke_title_law_1
            }
            add_law = revoke_title_law_0
          }
          if = {
            limit = {
              has_law = revoke_title_law_2
            }
            add_law = revoke_title_law_0
          }
        }
      }
      abdicate = yes
    }
    ROOT = {
      participation_scaled_prestige = 250
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 250
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      remove_opinion = {
        who = ROOT
        modifier = declared_war
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      participation_scaled_prestige = 50
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_council_power_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  on_defender_leader_death = {
    hidden_tooltip = {
      any_attacker = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = invalid
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
overthrow_ruler_no_calls = {
  name = CB_NAME_OVERTHROWRULER_NC
  war_name = WAR_NAME_OVERTHROWRULER_NC
  sprite = 12
  truce_days = 3650
  is_revolt_cb = yes
  can_call_vassals = no
  can_ask_to_join_war = no
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    FROM = {
      primary_title = {
        is_vice_royalty = no
      }
    }
    ROOT = {
      de_facto_liege = FROM
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
    FROM = {
      higher_tier_than = ROOT
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 200
      primary_title = {
        add_pressed_claim = FROM
      }
    }
    FROM = {
      prestige = -500
      remove_opinion = {
        who = ROOT
        modifier = declared_war
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_2
          }
        }
      }
      abdicate = yes
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      prestige = -100
      remove_opinion = {
        who = ROOT
        modifier = declared_war
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      prestige = 50
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
change_gavelkind_succession_law = {
  name = CB_NAME_GAVELKIND_SUCCESSION_LAW
  war_name = WAR_NAME_GAVELKIND_SUCCESSION_LAW
  sprite = 6
  truce_days = 3650
  attacker_can_call_allies = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      vassal_of = FROM
    }
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  is_valid_title = {
    NOT = {
      has_law = succ_gavelkind
    }
    OR = {
      tier = emperor
      tier = king
      is_primary_holder_title = yes
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          if = {
            limit = {
              OR = {
                tier = king
                tier = emperor
              }
              NOT = {
                has_law = crown_authority_0
              }
            }
            if = {
              limit = {
                has_law = crown_authority_1
              }
              add_law = crown_authority_0
            }
            if = {
              limit = {
                has_law = crown_authority_2
              }
              add_law = crown_authority_1
            }
            if = {
              limit = {
                has_law = crown_authority_3
              }
              add_law = crown_authority_2
            }
            if = {
              limit = {
                has_law = crown_authority_4
              }
              add_law = crown_authority_3
            }
          }
        }
      }
    }
    ROOT = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        disband_event_forces = faction_revolters
      }
    }
  }
  on_success_title = {
    succession_w_cooldown = gavelkind
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_succ_gavelkind_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_succ_gavelkind_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
lower_crown_authority_law = {
  name = CB_NAME_LOWER_CROWN_AUTHORITY_LAW
  war_name = WAR_NAME_LOWER_CROWN_AUTHORITY_LAW
  sprite = 6
  truce_days = 3650
  can_call_allies = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      vassal_of = FROM
    }
    NOT = {
      has_dlc = Zeus
    }
  }
  can_use_title = {
    holder_scope = {
      independent = yes
    }
    OR = {
      tier = king
      tier = emperor
    }
    OR = {
      has_law = crown_authority_1
      has_law = crown_authority_2
      has_law = crown_authority_3
      has_law = crown_authority_4
    }
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      opinion = {
        modifier = opinion_lowered_crown_authority
        who = FROM
        months = 12
      }
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        has_law = crown_authority_1
      }
      add_law_w_cooldown = crown_authority_0
    }
    if = {
      limit = {
        has_law = crown_authority_2
      }
      add_law_w_cooldown = crown_authority_1
    }
    if = {
      limit = {
        has_law = crown_authority_3
      }
      add_law_w_cooldown = crown_authority_2
    }
    if = {
      limit = {
        has_law = crown_authority_4
      }
      add_law_w_cooldown = crown_authority_3
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_lower_CA_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_lower_CA_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
lower_tribal_organization_law = {
  name = CB_NAME_LOWER_TRIBAL_ORGANIZATION_LAW
  war_name = WAR_NAME_LOWER_TRIBAL_ORGANIZATION_LAW
  sprite = 6
  truce_days = 3650
  can_call_allies = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      vassal_of = FROM
    }
  }
  can_use_title = {
    holder_scope = {
      independent = yes
    }
    OR = {
      tier = duke
      tier = king
      tier = emperor
    }
    OR = {
      has_law = tribal_organization_1
      has_law = tribal_organization_2
      has_law = tribal_organization_3
      has_law = tribal_organization_4
    }
  }
  is_valid = {
    FROM = {
      is_tribal = yes
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      opinion = {
        modifier = opinion_lowered_tribal_organization
        who = FROM
        months = 12
      }
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        has_law = tribal_organization_1
      }
      add_law_w_cooldown = tribal_organization_0
    }
    if = {
      limit = {
        has_law = tribal_organization_2
      }
      add_law_w_cooldown = tribal_organization_1
    }
    if = {
      limit = {
        has_law = tribal_organization_3
      }
      add_law_w_cooldown = tribal_organization_2
    }
    if = {
      limit = {
        has_law = tribal_organization_4
      }
      add_law_w_cooldown = tribal_organization_3
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_lower_TO_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_lower_TO_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
coastal_republic = {
  name = CB_NAME_COASTAL_REPUBLIC
  war_name = WAR_NAME_COASTAL_REPUBLIC
  sprite = 1
  truce_days = 3650
  is_permanent = yes
  check_all_titles = yes
  can_ask_to_join_war = no
  allow_distant = yes
  allowed_to_target_tributaries = no
  sort_priority = 700
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      OR = {
        is_merchant_republic = yes
        is_patrician = yes
      }
      NOT = {
        is_liege_or_above = FROM
      }
      NOT = {
        is_vassal_or_below = FROM
      }
      NOT = {
        same_liege = FROM
      }
      mercenary = no
    }
  }
  can_use_title = {
    tier = BARON
    is_capital = no
    holding_type = city
    location = {
      port = yes
      OR = {
        PREV = {
          holder_scope = {
            NOT = {
              same_realm = ROOT
            }
            OR = {
              is_patrician = yes
              is_merchant_republic = yes
            }
          }
        }
        trade_post_owner = {
          OR = {
            character = ROOT
            is_liege_or_above = ROOT
          }
        }
      }
      FROM = {
        OR = {
          is_merchant_republic = no
          capital_scope = {
            NOT = {
              province_id = PREVPREV
            }
          }
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        is_merchant_republic = yes
        is_patrician = yes
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        NOT = {
          location = {
            trade_post_owner = {
              is_liege_or_above = ROOT
            }
          }
        }
      }
      usurp_title = {
        target = ROOT
        type = invasion
      }
    }
    if = {
      limit = {
        location = {
          trade_post_owner = {
            is_liege_or_above = ROOT
          }
        }
      }
      location = {
        trade_post_owner = {
          usurp_title = {
            target = PREVPREV
            type = invasion
          }
        }
      }
    }
    ROOT = {
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 50
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 50
  }
}
coastal_county_republic = {
  name = CB_NAME_COASTAL_COUNTY_REPUBLIC
  war_name = WAR_NAME_COASTAL_COUNTY_REPUBLIC
  sprite = 1
  truce_days = 3650
  is_permanent = yes
  check_all_titles = yes
  can_ask_to_join_war = no
  allow_distant = yes
  allowed_to_target_tributaries = no
  sort_priority = 700
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      OR = {
        is_merchant_republic = yes
        is_patrician = yes
      }
      NOT = {
        is_liege_or_above = FROM
      }
      NOT = {
        is_vassal_or_below = FROM
      }
      NOT = {
        same_liege = FROM
      }
      mercenary = no
    }
  }
  can_use_title = {
    tier = COUNT
    location = {
      port = yes
      county = {
        any_direct_de_jure_vassal_title = {
          holder_scope = {
            OR = {
              character = ROOT
              is_liege_or_above = ROOT
            }
          }
        }
      }
      any_neighbor_province = {
        OR = {
          AND = {
            has_owner = yes
            owner = {
              OR = {
                character = ROOT
                is_liege_or_above = ROOT
              }
            }
          }
          AND = {
            is_land = no
            any_neighbor_province = {
              OR = {
                AND = {
                  has_owner = yes
                  owner = {
                    OR = {
                      character = ROOT
                      is_liege_or_above = ROOT
                    }
                  }
                }
                AND = {
                  is_land = no
                  any_neighbor_province = {
                    owner = {
                      OR = {
                        character = ROOT
                        is_liege_or_above = ROOT
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        is_merchant_republic = yes
        is_patrician = yes
      }
    }
  }
  is_valid_title = {
    tier = COUNT
    location = {
      port = yes
      county = {
        any_direct_de_jure_vassal_title = {
          holder_scope = {
            OR = {
              character = ROOT
              is_liege_or_above = ROOT
            }
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        any_direct_de_jure_vassal_title = {
          holder_scope = {
            character = ROOT
          }
        }
      }
      usurp_title = ROOT
    }
    if = {
      limit = {
        NOT = {
          any_direct_de_jure_vassal_title = {
            holder_scope = {
              character = ROOT
            }
          }
        }
      }
      any_de_jure_vassal_title = {
        limit = {
          holder_scope = {
            is_liege_or_above = ROOT
          }
        }
        holder_scope = {
          usurp_title = PREVPREV
          set_defacto_liege = ROOT
        }
      }
    }
    ROOT = {
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
weaken_vassal_plot = {
  name = CB_NAME_WEAKEN_VASSAL
  war_name = WAR_NAME_WEAKEN_VASSAL
  sprite = 3
  truce_days = 3650
  hostile_against_others = yes
  press_claim = yes
  attacker_can_call_allies = no
  can_ask_to_join_war = no
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      participation_scaled_prestige = 100
    }
    FROM = {
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
  }
  on_success_title = {
    FROM = {
      random_vassal = {
        limit = {
          tier = count
          any_demesne_title = {
            tier = count
            dejure_liege_title = {
              ROOT = {
                plot_target_title = {
                  title = PREVPREV
                }
              }
            }
          }
        }
        grant_title = PREVPREV
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
      cancel_plot = plot_weaken_fellow_vassal
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_invalidation = {
    ROOT = {
      cancel_plot = plot_weaken_fellow_vassal
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      imprison = FROM
      cancel_plot = plot_weaken_fellow_vassal
    }
    FROM = {
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  on_attacker_leader_death = {
    hidden_tooltip = {
      any_defender = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
decadence_invasion = {
  name = CB_NAME_INVASION
  war_name = WAR_NAME_DEC_INVASION
  sprite = 7
  truce_days = 3650
  hostile_against_others = yes
  can_ask_to_join_war = no
  can_use = {
    ROOT = {
      has_character_flag = decadence_invader
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    any_playable_ruler = {
      limit = {
        ai = no
        NOT = {
          character = FROM
        }
        NOT = {
          dynasty = FROM
        }
        NOT = {
          any_liege = {
            character = FROM
          }
        }
        OR = {
          FROM = {
            higher_tier_than = DUKE
          }
          any_realm_province = {
            any_neighbor_province = {
              owner = {
                any_liege = {
                  character = FROM
                }
              }
            }
          }
        }
      }
      narrative_event = {
        id = 91241
      }
    }
    FROM = {
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          if = {
            limit = {
              OR = {
                tier = king
                tier = emperor
              }
              NOT = {
                has_law = crown_authority_0
              }
            }
            add_law = crown_authority_0
          }
        }
      }
    }
    ROOT = {
      prestige = 200
      piety = 100
      occupy_minors_of_occupied_settlements = FROM
      gain_all_occupied_titles = {
        who = FROM
        type = revolt
      }
      give_nickname = nick_the_conqueror
      participation_scaled_prestige = 200
      participation_scaled_piety = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
        participation_scaled_piety = 100
      }
    }
    FROM = {
      prestige = -200
      primary_title = {
        holder_scope = {
          any_demesne_title = {
            limit = {
              higher_tier_than = COUNT
              NOT = {
                tier = PREVPREV
              }
            }
            usurp_title_plus_barony_if_unlanded = {
              target = ROOT
              type = revolt
            }
            if = {
              limit = {
                NOT = {
                  culture = ROOT
                }
              }
              hidden_tooltip = {
                conquest_culture = ROOT
              }
            }
          }
          any_demesne_title = {
            limit = {
              tier = PREVPREV
            }
            destroy_landed_title = THIS
          }
        }
      }
      set_defacto_liege = ROOT
      imprison = ROOT
      hidden_tooltip = {
        if = {
          limit = {
            has_nickname = no
          }
          random_list = {
            10 = {
              give_nickname = nick_the_decadent
            }
            10 = {
              give_nickname = nick_the_unready
            }
            10 = {
              give_nickname = nick_the_ill_ruler
            }
          }
        }
      }
    }
    hidden_tooltip = {
      ROOT = {
        disband_event_forces = decadence_revolters
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -200
    }
    FROM = {
      prestige = 100
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      ROOT = {
        disband_event_forces = decadence_revolters
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      set_defacto_liege = FROM
    }
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 8.0
      }
    }
    FROM = {
      prestige = 200
    }
    ROOT = {
      imprison = FROM
      disband_event_forces = decadence_revolters
    }
    if = {
      limit = {
        FROM = {
          ai = no
          NOT = {
            has_character_flag = achievement_decadent_warrior
          }
        }
      }
      FROM = {
        set_character_flag = achievement_decadent_warrior
      }
    }
  }
  on_reverse_demand_title = {
    ROOT = {
      show_scope_change = no
      remove_claim = PREV
    }
  }
  attacker_ai_victory_worth = {
    factor = 100
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 150
  }
}

cb_faction_independence = {
  name = CB_NAME_INDEPENDENCE
  war_name = WAR_NAME_FACTION_INDEPENDENCE
  sprite = 12
  truce_days = 3650
  major_revolt = yes
  attacker_can_call_allies = no
  can_ask_to_join_war = no
  is_independence = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      vassal_of = FROM
      mercenary = no
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
    FROM = {
      any_demesne_title = {
        NOT = {
          lower_tier_than = ROOT
        }
        temporary = no
      }
      independent = yes
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    if = {
      limit = {
        FROM = {
          independent = yes
        }
      }
      any_attacker = {
        limit = {
          OR = {
            vassal_of = FROM
            liege_before_war = {
              character = FROM
            }
          }
        }
        set_defacto_liege = THIS
        hidden_tooltip = {
          prestige = 100
          any_demesne_title = {
            limit = {
              controls_religion = no
              higher_tier_than = BARON
              FROM = {
                OR = {
                  NOT = {
                    religion_group = pagan_group
                  }
                  NOT = {
                    culture_group = PREVPREV
                  }
                }
              }
            }
            add_weak_pressed_claim = FROM
          }
          set_character_flag = ai_flag_never_transfer
        }
      }
    }
    ROOT = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      if = {
        limit = {
          NOT = {
            has_dlc = Zeus
          }
        }
        any_demesne_title = {
          limit = {
            OR = {
              tier = king
              tier = emperor
            }
            NOT = {
              has_law = crown_authority_0
            }
          }
          if = {
            limit = {
              has_law = crown_authority_1
            }
            add_law = crown_authority_0
          }
          if = {
            limit = {
              has_law = crown_authority_2
            }
            add_law = crown_authority_1
          }
          if = {
            limit = {
              has_law = crown_authority_3
            }
            add_law = crown_authority_2
          }
          if = {
            limit = {
              has_law = crown_authority_4
            }
            add_law = crown_authority_3
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -50
      add_character_modifier = {
        name = faction_independence_ultimatum_timer
        hidden = yes
        duration = 3650
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
      participation_scaled_prestige = -50
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = -50
        disband_event_forces = faction_revolters
      }
      add_character_modifier = {
        name = faction_independence_ultimatum_timer
        hidden = yes
        duration = 3650
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -100
      prisoner = FROM
      add_character_modifier = {
        name = faction_independence_ultimatum_timer
        hidden = yes
        duration = 3650
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
      participation_scaled_prestige = -100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
        liege = {
          character = FROM
        }
      }
      prisoner = FROM
      participation_scaled_prestige = -100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_independence_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      prestige = 50
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
  }
  on_attacker_leader_death = {
    hidden_tooltip = {
      any_defender = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 150
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
imperial_reconquest = {
  name = CB_NAME_IMPERIAL
  war_name = WAR_NAME_IMPERIAL
  sprite = 17
  truce_days = 3650
  is_permanent = yes
  check_de_jure_tier = DUKE
  allowed_to_target_tributaries = no
  sort_priority = 1900
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      has_landed_title = e_roman_empire
      independent = yes
      OR = {
        religion_group = christian
        religion = hellenic_pagan
        religion = hellenic_pagan_reformed
      }
      NOT = {
        same_realm = FROM
      }
      mercenary = no
    }
    FROM = {
      NOT = {
        religion_group = muslim
      }
    }
  }
  can_use_title = {
    OR = {
      de_jure_liege_or_above = k_byzantium
      de_jure_liege_or_above = k_thrace
      de_jure_liege_or_above = k_anatolia
      de_jure_liege_or_above = k_epirus
      de_jure_liege_or_above = k_trebizond
      de_jure_liege_or_above = k_armenia
      de_jure_liege_or_above = k_bulgaria
      de_jure_liege_or_above = k_serbia
      de_jure_liege_or_above = k_croatia
      de_jure_liege_or_above = k_italy
      de_jure_liege_or_above = k_sicily
      de_jure_liege_or_above = k_bavaria
      de_jure_liege_or_above = k_burgundy
      de_jure_liege_or_above = k_france
      de_jure_liege_or_above = k_aquitaine
      de_jure_liege_or_above = k_brittany
      de_jure_liege_or_above = k_england
      de_jure_liege_or_above = k_wales
      de_jure_liege_or_above = k_frisia
      de_jure_liege_or_above = k_lotharingia
      de_jure_liege_or_above = k_aragon
      de_jure_liege_or_above = k_castille
      de_jure_liege_or_above = k_andalusia
      de_jure_liege_or_above = k_badajoz
      de_jure_liege_or_above = k_valencia
      de_jure_liege_or_above = k_leon
      de_jure_liege_or_above = k_spanish_galicia
      de_jure_liege_or_above = k_portugal
      de_jure_liege_or_above = k_navarra
      de_jure_liege_or_above = k_syria
      de_jure_liege_or_above = k_jerusalem
      de_jure_liege_or_above = k_egypt
      de_jure_liege_or_above = k_africa
      de_jure_liege_or_above = k_mauretania
      de_jure_liege_or_above = k_papal_state
      de_jure_liege_or_above = k_papacy
      de_jure_liege_or_above = k_venice
      de_jure_liege_or_above = k_asturias
      de_jure_liege_or_above = k_sardinia
      de_jure_liege_or_above = k_antioch
      de_jure_liege_or_above = k_cyprus
      de_jure_liege_or_above = k_amalfi
      de_jure_liege_or_above = k_venice
      de_jure_liege_or_above = k_pisa
      de_jure_liege_or_above = k_genoa
      de_jure_liege_or_above = k_switzerland
      de_jure_liege_or_above = k_romagna
      de_jure_liege_or_above = k_carinthia
    }
  }
  is_valid = {
    ROOT = {
      independent = yes
      OR = {
        religion_group = christian
        religion = hellenic_pagan
        religion = hellenic_pagan_reformed
      }
      NOT = {
        same_realm = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    FROM = {
      prestige = -100
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = other_invasion_succ_tip
      hidden_tooltip = {
        ROOT = {
          vassalize_or_take_under_title = {
            title = PREV
            enemy = FROM
            type = invasion
          }
        }
      }
    }
    if = {
      limit = {
        holder_scope = {
          character = FROM
        }
      }
      usurp_title_only = {
        target = ROOT
        type = invasion
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -150
    }
  }
  on_reverse_demand = {
    ROOT = {
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
      ROOT = {
        prestige = -200
      }
    }
    FROM = {
      participation_scaled_piety = 100
      participation_scaled_prestige = 200
      if = {
        limit = {
          uses_decadence = yes
        }
        participation_scaled_decadence = -10
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_piety = 100
        participation_scaled_prestige = 200
        if = {
          limit = {
            uses_decadence = yes
          }
          participation_scaled_decadence = -10
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
embargo_cb = {
  name = CB_NAME_EMBARGO
  war_name = WAR_NAME_EMBARGO
  sprite = 19
  truce_days = 3650
  is_permanent = yes
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  sort_priority = 2000
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      independent = yes
      NOT = {
        has_embargo = FROM
      }
      mercenary = no
    }
    FROM = {
      OR = {
        AND = {
          is_merchant_republic = yes
          any_trade_post = {
            owner = {
              OR = {
                character = ROOT
                is_liege_or_above = ROOT
              }
            }
          }
        }
        AND = {
          OR = {
            is_merchant_republic = yes
            higher_tier_than = DUKE
          }
          any_realm_lord = {
            is_patrician = yes
            any_trade_post = {
              owner = {
                OR = {
                  character = ROOT
                  is_liege_or_above = ROOT
                }
              }
            }
          }
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      independent = yes
      NOT = {
        has_embargo = FROM
      }
    }
    FROM = {
      OR = {
        is_merchant_republic = yes
        AND = {
          higher_tier_than = DUKE
          any_realm_lord = {
            is_merchant_republic = yes
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      embargo = FROM
      if = {
        limit = {
          NOT = {
            religion = FROM
          }
        }
        piety = 200
      }
    }
  }
  on_fail = {
    if = {
      limit = {
        NOT = {
          any_attacker = {
            NOT = {
              character = ROOT
            }
            is_merchant_republic = yes
          }
        }
      }
      ROOT = {
        prestige = -100
      }
    }
    if = {
      limit = {
        any_attacker = {
          NOT = {
            character = ROOT
          }
          is_merchant_republic = yes
        }
      }
      any_attacker = {
        limit = {
          NOT = {
            character = ROOT
          }
          is_merchant_republic = yes
        }
        prestige = -100
      }
    }
    FROM = {
      prestige = 50
    }
  }
  on_reverse_demand = {
    if = {
      limit = {
        NOT = {
          any_attacker = {
            NOT = {
              character = ROOT
            }
            is_merchant_republic = yes
          }
        }
      }
      ROOT = {
        prestige = -200
        transfer_scaled_wealth = {
          to = FROM
          value = 4.0
        }
      }
    }
    if = {
      limit = {
        any_attacker = {
          NOT = {
            character = ROOT
          }
          is_merchant_republic = yes
        }
      }
      any_attacker = {
        limit = {
          NOT = {
            character = ROOT
          }
          is_merchant_republic = yes
        }
        prestige = -200
        transfer_scaled_wealth = {
          to = FROM
          value = 4.0
        }
      }
    }
    FROM = {
      prestige = 100
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 50
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 50
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
    modifier = {
      factor = 0
      ROOT = {
        opinion = {
          who = FROM
          value = 25
        }
      }
    }
    modifier = {
      factor = 0.5
      ROOT = {
        opinion = {
          who = FROM
          value = 0
        }
      }
    }
    modifier = {
      factor = 0.5
      ROOT = {
        opinion = {
          who = FROM
          value = -25
        }
      }
    }
  }
}
seize_trade_post = {
  name = CB_NAME_SEIZE_TRADE_POST
  war_name = WAR_NAME_SEIZE_TRADE_POST
  sprite = 18
  truce_days = 1825
  is_permanent = yes
  check_all_trade_posts = yes
  can_ask_to_join_war = no
  att_ticking_war_score_multiplier = 5.0
  def_ticking_war_score_multiplier = 5.0
  allow_distant = yes
  allowed_to_target_tributaries = no
  sort_priority = 1900
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      OR = {
        is_merchant_republic = yes
        is_patrician = yes
      }
      NOT = {
        is_liege_or_above = FROM
      }
      OR = {
        NOT = {
          same_realm = FROM
        }
        NOT = {
          num_of_trade_post_diff = {
            character = FROM
            value = 3
          }
        }
      }
      mercenary = no
    }
    FROM = {
      NOT = {
        is_liege_or_above = ROOT
      }
    }
  }
  can_use_title = {
    tier = COUNT
    location = {
      port = yes
    }
    has_trade_post = yes
    trade_post_owner = {
      OR = {
        character = FROM
        is_liege_or_above = FROM
      }
    }
    holder_scope = {
      NOT = {
        character = FROM
      }
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        is_merchant_republic = yes
        is_patrician = yes
      }
      NOT = {
        is_liege_or_above = FROM
      }
    }
    FROM = {
      NOT = {
        is_liege_or_above = ROOT
      }
    }
  }
  is_valid_title = {
    has_trade_post = yes
    trade_post_owner = {
      OR = {
        character = FROM
        is_liege_or_above = FROM
      }
    }
    holder_scope = {
      NOT = {
        character = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    seize_trade_post = ROOT
    ROOT = {
      participation_scaled_prestige = 50
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -50
    }
    FROM = {
      participation_scaled_prestige = 25
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 25
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -100
      transfer_scaled_wealth = {
        to = FROM
        value = 2.0
      }
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 25
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 25
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
    modifier = {
      factor = 0.25
      ROOT = {
        NOT = {
          same_realm = FROM
        }
      }
    }
  }
}

pagan_subjugation = {
  name = CB_NAME_PAGAN_SUBJUGATION
  war_name = WAR_NAME_PAGAN_SUBJUGATION
  sprite = 8
  truce_days = 365
  is_permanent = yes
  can_ask_to_join_war = yes
  allowed_to_target_tributaries = no
  defender_unoccupied_warscore = yes
  sort_priority = 2000
  can_use = {
    ROOT = {
      religion_group = pagan_group
      is_reformed_religion = no
      NOT = {
        religion = hellenic_pagan
      }
      NOT = {
        same_realm = FROM
      }
      NOT = {
        is_liege_or_above = FROM
      }
      mercenary = no
      OR = {
        AND = {
          has_dlc = "Horse Lords"
          is_nomadic = no
        }
        AND = {
          NOT = {
            has_dlc = "Horse Lords"
          }
          has_horde_culture = no
        }
      }
      OR = {
        is_tribal = yes
        primary_title = {
          has_law = succ_elective_gavelkind
        }
      }
      OR = {
        NOT = {
          has_character_modifier = launched_subjugation
        }
        AND = {
          has_ambition = obj_become_king
          capital_scope = {
            kingdom = {
              FROM = {
                any_realm_title = {
                  kingdom = {
                    title = PREVPREVPREV
                  }
                }
              }
            }
          }
        }
      }
    }
    OR = {
      NOT = {
        ROOT = {
          religion = aztec
        }
      }
      FROM = {
        religion = aztec
      }
    }
    FROM = {
      in_revolt = no
      religion_group = pagan_group
      is_nomadic = no
      NOT = {
        is_offmap_governor = yes
      }
      OR = {
        is_reformed_religion = no
        is_reformed_religion = ROOT
      }
      NOT = {
        any_war = {
          defender = {
            character = PREVPREV
          }
          OR = {
            using_cb = pagan_subjugation
            using_cb = nomad_subjugation
          }
        }
      }
    }
  }
  on_add = {
    ROOT = {
      add_character_modifier = {
        name = launched_subjugation
        years = 100
        hidden = yes
      }
    }
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      piety = 100
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    FROM = {
      piety = -100
      prestige = -100
      if = {
        limit = {
          is_reformed_religion = ROOT
          controls_religion = no
        }
        religion = ROOT
      }
      custom_tooltip = {
        text = tribal_subjugation_tip
      }
      hidden_tooltip = {
        opinion = {
          modifier = opinion_subjugated
          who = ROOT
        }
        any_vassal = {
          opinion = {
            modifier = opinion_subjugated
            who = ROOT
          }
        }
        any_demesne_title = {
          limit = {
            higher_tier_than = ROOT
          }
          ROOT = {
            usurp_title = {
              target = PREV
              type = invasion
            }
          }
          add_pressed_claim = PREV
        }
        any_demesne_title = {
          limit = {
            tier = ROOT
          }
          ROOT = {
            usurp_title = {
              target = PREV
              type = invasion
            }
          }
          add_pressed_claim = PREV
        }
        set_defacto_liege = ROOT
      }
    }
  }
  on_fail = {
    FROM = {
      piety = 50
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    ROOT = {
      piety = -100
    }
  }
  on_invalidation = {
    ROOT = {
      remove_character_modifier = launched_subjugation
    }
  }
  on_reverse_demand = {
    ROOT = {
      piety = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 2.0
      }
    }
    FROM = {
      piety = 100
      if = {
        limit = {
          has_dlc = "Legacy of Rome"
          OR = {
            has_landed_title = e_byzantium
            has_landed_title = e_roman_empire
          }
          OR = {
            religion_group = christian
            religion = hellenic_pagan
            religion = hellenic_pagan_reformed
          }
        }
        hidden_tooltip = {
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
  }
}
peasant_revolt = {
  name = CB_NAME_PEASANT_CONQUEST
  war_name = WAR_NAME_PEASANT_CONQUEST
  sprite = 16
  truce_days = 365
  hostile_against_others = yes
  check_all_titles = yes
  press_claim = yes
  attacker_can_call_allies = no
  defender_can_call_allies = no
  can_ask_to_join_war = no
  is_independence = yes
  can_use = {
    ROOT = {
      primary_title = {
        temporary = yes
      }
      war = no
      NOT = {
        is_liege_or_above = FROM
      }
      mercenary = no
    }
  }
  can_use_title = {
    tier = count
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    usurp_title_plus_barony_if_unlanded = {
      target = ROOT
      type = revolt
    }
    ROOT = {
      set_defacto_liege = ROOT
    }
    FROM = {
      prestige = -100
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail_title = {
    FROM = {
      prestige = 10
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
      }
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
      }
    }
  }
  on_reverse_demand = {
    FROM = {
      prestige = 20
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
        add_character_modifier = {
          name = crushed_revolt
          days = 3650
        }
      }
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
heretic_revolt = {
  name = CB_NAME_HERETIC_UPRISING
  war_name = WAR_NAME_HERETIC_UPRISING
  sprite = 7
  truce_days = 365
  hostile_against_others = yes
  attacker_can_call_allies = no
  defender_can_call_allies = no
  can_ask_to_join_war = no
  check_de_jure_tier = DUKE
  can_use = {
    ROOT = {
      has_character_flag = heretic_revolter
    }
  }
  is_valid = {
    FROM = {
      NOT = {
        religion = ROOT
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 200
      piety = 100
      occupy_minors_of_occupied_settlements = FROM
      gain_all_occupied_titles = {
        who = FROM
        type = revolt
      }
      clr_character_flag = heretic_revolter
    }
    FROM = {
      prestige = -500
      piety = -500
      religion_authority = {
        modifier = lost_heretic_revolt
      }
    }
  }
  on_success_title = {
    ROOT = {
      vassalize_or_take_under_title = {
        title = PREV
        enemy = FROM
        same_religion = yes
        is_religious = yes
        type = holy_war
      }
    }
    if = {
      limit = {
        controls_religion = no
        holder_scope = {
          OR = {
            character = FROM
            is_liege_or_above = FROM
          }
        }
      }
      usurp_title = {
        target = ROOT
        type = holy_war
      }
    }
    if = {
      limit = {
        has_holder = no
      }
      usurp_title = {
        target = ROOT
        type = holy_war
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      clr_character_flag = heretic_revolter
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
      }
    }
    FROM = {
      prestige = 50
      piety = 100
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
      }
      religion_authority = {
        modifier = won_heretic_revolt
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      clr_character_flag = heretic_revolter
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
      }
    }
    FROM = {
      prestige = 100
      piety = 200
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
        add_character_modifier = {
          name = crushed_revolt
          days = 3650
        }
      }
      religion_authority = {
        modifier = won_heretic_revolt
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = 100
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 150
  }
}
religious_revolt = {
  name = CB_NAME_HERETIC_UPRISING
  war_name = WAR_NAME_HERETIC_UPRISING
  sprite = 7
  truce_days = 365
  hostile_against_others = yes
  attacker_can_call_allies = no
  defender_can_call_allies = no
  can_ask_to_join_war = no
  check_de_jure_tier = DUKE
  can_use = {
    ROOT = {
      has_character_flag = religious_revolter
    }
  }
  is_valid = {
    FROM = {
      NOT = {
        religion = ROOT
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 200
      piety = 100
      occupy_minors_of_occupied_settlements = FROM
      gain_all_occupied_titles = {
        who = FROM
        type = revolt
      }
      clr_character_flag = religious_revolter
    }
    FROM = {
      prestige = -500
      piety = -500
      religion_authority = {
        modifier = lost_religious_revolt
      }
    }
  }
  on_success_title = {
    ROOT = {
      vassalize_or_take_under_title = {
        title = PREV
        enemy = FROM
        same_religion = yes
        is_religious = yes
        type = holy_war
      }
    }
    if = {
      limit = {
        controls_religion = no
        holder_scope = {
          OR = {
            character = FROM
            is_liege_or_above = FROM
          }
        }
      }
      usurp_title = {
        target = ROOT
        type = holy_war
      }
    }
    if = {
      limit = {
        has_holder = no
      }
      usurp_title = {
        target = ROOT
        type = holy_war
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      clr_character_flag = religious_revolter
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
      }
    }
    FROM = {
      prestige = 50
      piety = 100
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
      }
      religion_authority = {
        modifier = won_religious_revolt
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      clr_character_flag = religious_revolter
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
      }
    }
    FROM = {
      prestige = 100
      piety = 200
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
        add_character_modifier = {
          name = crushed_revolt
          days = 3650
        }
      }
      religion_authority = {
        modifier = won_religious_revolt
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = 100
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 150
  }
}
liberation_revolt = {
  name = CB_NAME_LIBERATION_REVOLT
  war_name = WAR_NAME_LIBERATION_REVOLT
  sprite = 16
  truce_days = 365
  hostile_against_others = yes
  check_de_jure_tier = KING
  press_claim = yes
  can_ask_to_join_war = no
  is_independence = yes
  can_use = {
    ROOT = {
      has_character_flag = nationalist_rebel
    }
  }
  can_use_title = {
    tier = king
    has_holder = no
  }
  is_valid = {
    FROM = {
      NOT = {
        culture = ROOT
      }
    }
  }
  is_valid_title = {
    has_holder = no
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 1000
      occupy_minors_of_occupied_settlements = FROM
      gain_all_occupied_titles = {
        who = FROM
        type = revolt
      }
      clr_character_flag = nationalist_rebel
      give_nickname = nick_the_liberator
    }
    FROM = {
      prestige = -500
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = tribal_invasion_succ_tip
      hidden_tooltip = {
        ROOT = {
          vassalize_or_take_under_title = {
            title = PREV
            enemy = FROM
            is_revolt = yes
            type = revolt
          }
          if = {
            limit = {
              num_of_count_titles = 5
              PREV = {
                OR = {
                  has_holder = no
                  holder_scope = {
                    character = FROM
                  }
                }
              }
            }
            usurp_title = {
              target = PREV
              type = revolt
            }
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail_title = {
    FROM = {
      prestige = 100
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
      }
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      clr_character_flag = nationalist_rebel
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
        remove_trait = inspiring_leader
      }
    }
  }
  on_reverse_demand = {
    FROM = {
      prestige = 200
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
        add_character_modifier = {
          name = crushed_major_revolt
          days = 3650
        }
      }
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      clr_character_flag = nationalist_rebel
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
        remove_trait = inspiring_leader
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = 100
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
duchy_adventure = {
  name = CB_NAME_DUCHY_ADVENTURE
  war_name = WAR_DUCHY_ADVENTURE
  sprite = 9
  truce_days = 3650
  hostile_against_others = yes
  check_de_jure_tier = DUKE
  can_use = {
    ROOT = {
      has_character_flag = duchy_adventurer
    }
  }
  is_valid = {
    always = yes
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 250
      hidden_tooltip = {
        clr_character_flag = duchy_adventurer
        give_nickname = nick_the_conqueror
      }
    }
    FROM = {
      prestige = -250
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = other_invasion_succ_tip
      hidden_tooltip = {
        ROOT = {
          vassalize_or_take_under_title = {
            title = PREV
            enemy = FROM
            type = host
          }
        }
      }
    }
    ROOT = {
      hidden_tooltip = {
        if = {
          limit = {
            has_character_flag = seljuk_himself
          }
          narrative_event = {
            id = 60206
            days = 1
          }
        }
        if = {
          limit = {
            has_character_flag = timur_himself
          }
          narrative_event = {
            id = 60306
            days = 1
          }
        }
        if = {
          limit = {
            has_character_flag = sabuktigin_himself
          }
          narrative_event = {
            id = 60406
            days = 1
          }
        }
        if = {
          limit = {
            has_character_flag = rum_creator
          }
          character_event = {
            id = 60610
            days = 600
            random = 300
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    FROM = {
      prestige = 100
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
      }
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      hidden_tooltip = {
        disband_event_forces = yes
        clr_character_flag = duchy_adventurer
      }
    }
    ROOT = {
      prestige = -100
    }
  }
  on_reverse_demand = {
    ROOT = {
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      prestige = 200
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      prestige = -200
      hidden_tooltip = {
        disband_event_forces = yes
        clr_character_flag = duchy_adventurer
      }
    }
  }
  on_attacker_leader_death = {
    ROOT = {
      hidden_tooltip = {
        disband_event_forces = yes
        clr_character_flag = duchy_adventurer
      }
    }
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
kingdom_adventure = {
  name = CB_NAME_DUCHY_ADVENTURE
  war_name = WAR_DUCHY_ADVENTURE
  sprite = 9
  truce_days = 3650
  hostile_against_others = yes
  check_de_jure_tier = KING
  can_use = {
    ROOT = {
      OR = {
        has_character_flag = duchy_adventurer
        has_character_flag = rum_creator
      }
    }
  }
  is_valid = {
    always = yes
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 500
      piety = 250
      hidden_tooltip = {
        clr_character_flag = duchy_adventurer
        clr_character_flag = do_not_disturb
        if = {
          limit = {
            has_nickname = no
          }
          FROM = {
            save_event_target_as = nickname_target
          }
          ROOT = {
            save_event_target_as = nickname_receiver
          }
          if = {
            limit = {
              NOT = {
                has_character_flag = is_child_of_destiny
              }
            }
            random_list = {
              5 = {
                give_nickname = nick_the_victorious
              }
              5 = {
                give_nickname = nick_the_conqueror
              }
              5 = {
                give_nickname = nick_the_dragon
              }
              10 = {
                give_nickname = nick_the_rel_group
              }
              10 = {
                give_nickname = nick_the_tiger
              }
              10 = {
                give_nickname = nick_the_world_burner
              }
              10 = {
                give_nickname = nick_the_scourge_of_god
                modifier = {
                  factor = 0
                  event_target:nickname_target = {
                    religion = ROOT
                  }
                }
              }
            }
          }
        }
      }
    }
    FROM = {
      prestige = -500
      piety = -250
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = other_invasion_succ_tip
      hidden_tooltip = {
        if = {
          limit = {
            ROOT = {
              has_character_flag = child_of_destiny_outwards_focus
            }
          }
          FROM = {
            random_realm_title = {
              limit = {
                tier = COUNT
                de_jure_liege_or_above = PREVPREV
              }
              usurp_title = {
                target = ROOT
                type = host
              }
            }
          }
          ROOT = {
            liege = {
              save_event_target_as = old_liege_target
            }
            if = {
              limit = {
                independent = no
              }
              any_demesne_title = {
                limit = {
                  NOR = {
                    title = PREVPREV
                    de_jure_liege_or_above = PREVPREV
                  }
                }
                grant_title = event_target:old_liege_target
              }
              any_vassal = {
                limit = {
                  capital_scope = {
                    NOR = {
                      title = PREVPREVPREV
                      de_jure_liege_or_above = PREVPREVPREV
                    }
                  }
                }
                set_defacto_liege = event_target:old_liege_target
              }
            }
          }
        }
        FROM = {
          any_demesne_title = {
            limit = {
              OR = {
                title = PREVPREV
                de_jure_liege_or_above = PREVPREV
              }
              NOT = {
                ROOT = {
                  has_character_flag = rum_creator
                }
              }
            }
            usurp_title = {
              target = ROOT
              type = host
            }
          }
        }
        if = {
          limit = {
            has_holder = no
          }
          usurp_title = {
            target = ROOT
            type = host
          }
        }
        if = {
          limit = {
            ROOT = {
              NOR = {
                any_demesne_title = {
                  tier = KING
                }
                has_character_flag = rum_creator
              }
            }
          }
          if = {
            limit = {
              ROOT = {
                NOT = {
                  has_character_flag = is_child_of_destiny
                }
              }
            }
            ROOT = {
              create_title = {
                tier = KING
                landless = no
                temporary = no
                custom_created = yes
                culture = ROOT
                holder = ROOT
                name = INDIAN_MUSLIM_KINGDOM
                base_title = PREV
                copy_title_laws = yes
              }
            }
          }
          else = {
            ROOT = {
              save_event_target_as = target_name
              create_title = {
                tier = KING
                landless = no
                temporary = no
                custom_created = yes
                culture = ROOT
                holder = ROOT
                name = DESTINY_KINGDOM
                base_title = PREV
                copy_title_laws = yes
              }
              capital_scope = {
                county = {
                  save_event_target_as = coa_target
                }
              }
              primary_title = {
                set_coa = event_target:coa_target
              }
            }
          }
        }
        if = {
          limit = {
            ROOT = {
              has_character_flag = rum_creator
            }
          }
          k_rum = {
            grant_title = ROOT
          }
        }
        ROOT = {
          vassalize_or_take_under_title = {
            title = PREV
            enemy = FROM
            type = host
          }
          set_defacto_liege = ROOT
        }
        hidden_effect = {
          if = {
            limit = {
              ROOT = {
                has_character_flag = is_child_of_destiny
                NOT = {
                  religion_group = muslim
                }
              }
            }
            ROOT = {
              any_demesne_title = {
                limit = {
                  higher_tier_than = COUNT
                }
                add_law = succ_primogeniture
              }
            }
          }
        }
      }
    }
    ROOT = {
      hidden_tooltip = {
        if = {
          limit = {
            has_character_flag = rum_creator
          }
          capital_scope = {
            culture = ROOT
          }
        }
        else_if = {
          limit = {
            has_character_flag = is_child_of_destiny
          }
          character_event = {
            id = HF.303
            days = 3
          }
        }
        else = {
          capital_scope = {
            reverse_culture = ROOT
          }
          any_child = {
            limit = {
              is_ruler = no
              ai = yes
            }
            culture = ROOT
          }
          any_courtier = {
            limit = {
              is_ruler = no
              ai = yes
            }
            culture = ROOT
          }
        }
        if = {
          limit = {
            has_character_flag = is_child_of_destiny
            higher_real_tier_than = DUKE
            NOT = {
              any_owned_bloodline = {
                has_bloodline_flag = created_bloodline
              }
            }
          }
          character_event = {
            id = HF.304
            days = 14
          }
        }
        if = {
          limit = {
            has_character_flag = rum_creator
          }
          character_event = {
            id = 60610
            days = 600
            random = 300
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_invalidation = {
    ROOT = {
      clr_character_flag = child_of_destiny_made_player_choice
      clr_character_flag = child_of_destiny_adventure
    }
  }
  on_fail = {
    FROM = {
      prestige = 100
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
      }
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      hidden_tooltip = {
        disband_event_forces = yes
        clr_character_flag = duchy_adventurer
        if = {
          limit = {
            has_character_flag = is_child_of_destiny
          }
          remove_trait = disinherited
        }
      }
    }
    ROOT = {
      prestige = -100
    }
    if = {
      limit = {
        ROOT = {
          has_character_flag = is_child_of_destiny
        }
      }
      set_global_flag = child_of_destiny_invasion_fail@ROOT
    }
  }
  on_reverse_demand = {
    ROOT = {
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      prestige = 200
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      prestige = -200
      hidden_tooltip = {
        disband_event_forces = yes
        clr_character_flag = duchy_adventurer
        if = {
          limit = {
            has_character_flag = is_child_of_destiny
          }
          remove_trait = disinherited
        }
      }
    }
    if = {
      limit = {
        ROOT = {
          has_character_flag = is_child_of_destiny
        }
      }
      set_global_flag = child_of_destiny_invasion_reverse_demand@ROOT
    }
  }
  on_attacker_leader_death = {
    ROOT = {
      hidden_tooltip = {
        disband_event_forces = yes
        clr_character_flag = duchy_adventurer
      }
    }
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}

caliphal_subjugation = {
  name = CB_NAME_PAGAN_SUBJUGATION
  war_name = WAR_NAME_PAGAN_SUBJUGATION
  sprite = 8
  truce_days = 365
  hostile_against_others = yes
  is_permanent = yes
  can_ask_to_join_war = yes
  check_de_jure_tier = KING
  allowed_to_target_tributaries = no
  sort_priority = 1000
  can_use_gui = {
    ROOT = {
      piety = 200
    }
  }
  on_add = {
    ROOT = {
      piety = -200
    }
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  can_use = {
    ROOT = {
      OR = {
        ai = yes
        multiplayer = no
        NOT = {
          has_game_rule = {
            name = multiplayer_invasions
            value = off
          }
        }
      }
      religion_group = muslim
      OR = {
        has_landed_title = d_sunni
        has_landed_title = d_shiite
        has_landed_title = d_ibadi
        has_landed_title = d_kharijite
        has_landed_title = d_yazidi
        has_landed_title = d_hurufi
      }
      is_nomadic = no
      OR = {
        has_horde_culture = no
        has_dlc = "Horse Lords"
      }
      NOT = {
        has_character_modifier = launched_subjugation
      }
      mercenary = no
    }
    FROM = {
      religion = ROOT
      NOT = {
        is_offmap_governor = yes
      }
    }
  }
  can_use_title = {
    FROM = {
      any_realm_province = {
        de_jure_liege_or_above = PREVPREV
      }
    }
  }
  is_valid_title = {
    FROM = {
      any_realm_province = {
        de_jure_liege_or_above = PREVPREV
      }
    }
  }
  on_add_title = {
    ROOT = {
      add_character_modifier = {
        name = launched_subjugation
        days = 3650
        hidden = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 100
      decadence = -5
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    FROM = {
      prestige = -200
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = pagan_subjugation_tip
      hidden_tooltip = {
        ROOT = {
          subjugate_or_take_under_title = {
            title = PREV
            enemy = FROM
          }
        }
      }
    }
  }
  on_fail = {
    FROM = {
      prestige = 50
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    ROOT = {
      prestige = -100
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 2.0
      }
    }
    FROM = {
      prestige = 100
      if = {
        limit = {
          has_dlc = "Legacy of Rome"
          OR = {
            has_landed_title = e_byzantium
            has_landed_title = e_roman_empire
          }
          OR = {
            religion_group = christian
            religion = hellenic_pagan
            religion = hellenic_pagan_reformed
          }
        }
        hidden_tooltip = {
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.9
    }
  }
}
muslim_county_conquest = {
  name = CB_NAME_COUNTY_CONQUEST
  war_name = WAR_NAME_COUNTY_CONQUEST
  sprite = 16
  truce_days = 1825
  hostile_against_others = yes
  is_permanent = yes
  check_all_titles = yes
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  sort_priority = 700
  can_use_gui = {
    ROOT = {
      piety = 50
    }
  }
  on_add = {
    ROOT = {
      piety = -50
    }
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  can_use = {
    ROOT = {
      NOT = {
        is_liege_or_above = FROM
      }
      mercenary = no
      is_nomadic = no
    }
  }
  can_use_title = {
    tier = count
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    ROOT = {
      religion_group = muslim
    }
    NOT = {
      OR = {
        ROOT = {
          has_landed_title = PREV
        }
        holder_scope = {
          is_liege_or_above = ROOT
        }
      }
    }
    location = {
      any_neighbor_province = {
        owner = {
          OR = {
            character = ROOT
            is_liege_or_above = ROOT
          }
        }
      }
    }
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        holder_scope = {
          tier = count
          NOT = {
            num_of_count_titles = 2
          }
          lower_tier_than = ROOT
        }
      }
      holder_scope = {
        set_defacto_liege = ROOT
      }
    }
    if = {
      limit = {
        holder_scope = {
          OR = {
            higher_tier_than = count
            num_of_count_titles = 2
            NOT = {
              lower_tier_than = ROOT
            }
          }
        }
      }
      usurp_title_plus_barony_if_unlanded = {
        target = ROOT
        type = invasion
      }
      any_de_jure_vassal_title = {
        limit = {
          has_holder = yes
          NOT = {
            de_facto_liege = PREV
          }
          holder_scope = {
            OR = {
              character = FROM
              is_liege_or_above = FROM
            }
          }
        }
        usurp_title_plus_barony_if_unlanded = {
          target = ROOT
          type = invasion
        }
      }
    }
    ROOT = {
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  on_fail_title = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.9
    }
    modifier = {
      factor = 0
      ROOT = {
        has_character_flag = is_temujin
        has_landed_title = e_mongol_empire
        demesne_size = 1
      }
      FROM = {
        has_landed_title = e_china_west_governor
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_nomadic = no
        NOT = {
          is_tribal = yes
        }
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_tribal = yes
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
              holding_type = tribal
            }
          }
        }
      }
    }
  }
}
pagan_county_conquest = {
  name = CB_NAME_COUNTY_CONQUEST
  war_name = WAR_NAME_COUNTY_CONQUEST
  sprite = 22
  truce_days = 1825
  hostile_against_others = yes
  is_permanent = yes
  check_all_titles = yes
  can_ask_to_join_war = no
  allow_distant = yes
  allowed_to_target_tributaries = no
  sort_priority = 700
  can_use = {
    ROOT = {
      mercenary = no
    }
    OR = {
      ROOT = {
        is_nomadic = yes
        NOT = {
          same_realm = FROM
        }
        FROM = {
          OR = {
            is_nomadic = yes
            is_tribal = yes
          }
        }
      }
      AND = {
        ROOT = {
          religion_group = pagan_group
          NOT = {
            same_realm = FROM
          }
        }
        FROM = {
          NOT = {
            religion = ROOT
          }
        }
      }
    }
  }
  can_use_title = {
    tier = count
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
        NOT = {
          same_realm = ROOT
        }
      }
    }
    NOT = {
      OR = {
        ROOT = {
          has_landed_title = PREV
        }
        holder_scope = {
          is_liege_or_above = ROOT
        }
      }
    }
    OR = {
      AND = {
        OR = {
          ROOT = {
            religion = norse_pagan
          }
          ROOT = {
            religion = norse_pagan_reformed
          }
        }
        location = {
          port = yes
        }
        has_global_flag = viking_age_started
      }
      location = {
        any_neighbor_province = {
          owner = {
            OR = {
              character = ROOT
              is_liege_or_above = ROOT
            }
          }
        }
      }
    }
  }
  is_valid_title = {
    OR = {
      ROOT = {
        is_nomadic = yes
      }
      AND = {
        ROOT = {
          religion_group = pagan_group
          NOT = {
            same_realm = FROM
          }
        }
        FROM = {
          NOT = {
            religion = ROOT
          }
        }
      }
    }
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    usurp_title_plus_barony_if_unlanded = {
      target = ROOT
      type = invasion
    }
    any_de_jure_vassal_title = {
      limit = {
        has_holder = yes
        holder_scope = {
          OR = {
            character = FROM
            is_liege_or_above = FROM
            AND = {
              is_liege_or_above = ROOT
              NOT = {
                culture = ROOT
              }
              NOT = {
                religion = ROOT
              }
            }
          }
        }
      }
      show_scope_change = no
      usurp_title = ROOT
    }
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 100
      participation_scaled_piety = 50
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        participation_scaled_piety = 50
      }
    }
    if = {
      limit = {
        NOT = {
          FROM = {
            religion = ROOT
          }
        }
      }
      ROOT = {
        show_scope_change = no
        religion_authority = {
          modifier = won_county_conquest
        }
      }
    }
    attacker = {
      save_event_target_as = attacker_target
    }
    defender = {
      save_event_target_as = defender_target
    }
    if = {
      limit = {
        event_target:attacker_target = {
          has_quest = quest_warrior_lodge_war
        }
        is_quest_target_of = event_target:attacker_target
      }
      event_target:attacker_target = {
        show_scope_change = no
        tooltip = {
          clr_quest = quest_warrior_lodge_war
        }
        set_character_flag = won_war@event_target:defender_target
      }
    }
  }
  on_fail_title = {
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
    if = {
      limit = {
        NOT = {
          FROM = {
            religion = ROOT
          }
        }
      }
      ROOT = {
        show_scope_change = no
        religion_authority = {
          modifier = lost_county_conquest
        }
      }
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    attacker = {
      save_event_target_as = attacker_target
    }
    defender = {
      save_event_target_as = defender_target
    }
    if = {
      limit = {
        event_target:attacker_target = {
          has_quest = quest_warrior_lodge_war
        }
        is_quest_target_of = event_target:attacker_target
      }
      event_target:attacker_target = {
        show_scope_change = no
        tooltip = {
          clr_quest = quest_warrior_lodge_war
        }
        set_character_flag = white_peace@event_target:defender_target
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    if = {
      limit = {
        NOT = {
          FROM = {
            religion = ROOT
          }
        }
      }
      ROOT = {
        show_scope_change = no
        religion_authority = {
          modifier = lost_county_conquest
        }
      }
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
      participation_scaled_piety = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        participation_scaled_piety = 50
      }
    }
  }
  on_reverse_demand_title = {
    attacker = {
      save_event_target_as = attacker_target
    }
    defender = {
      save_event_target_as = defender_target
    }
    if = {
      limit = {
        event_target:attacker_target = {
          has_quest = quest_warrior_lodge_war
        }
        is_quest_target_of = event_target:attacker_target
      }
      event_target:attacker_target = {
        show_scope_change = no
        tooltip = {
          clr_quest = quest_warrior_lodge_war
        }
        set_character_flag = lost_war@event_target:defender_target
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 4.0
      ROOT = {
        OR = {
          religion = norse_pagan
          religion = norse_pagan_reformed
        }
      }
      OR = {
        empire = {
          title = e_scandinavia
        }
        kingdom = {
          title = k_rus
        }
      }
    }
    modifier = {
      factor = 2.0
      ROOT = {
        OR = {
          religion = norse_pagan
          religion = norse_pagan_reformed
        }
      }
      has_global_flag = viking_age_started
      OR = {
        empire = {
          title = e_britannia
        }
        kingdom = {
          title = k_brittany
        }
        kingdom = {
          title = k_france
        }
        kingdom = {
          title = k_frisia
        }
      }
    }
    modifier = {
      factor = 2.0
      ROOT = {
        OR = {
          religion = norse_pagan
          religion = norse_pagan_reformed
        }
      }
      has_global_flag = viking_age_started
      FROM = {
        NOT = {
          religion_group = pagan_group
        }
      }
      location = {
        port = yes
      }
    }
    modifier = {
      factor = 0
      ROOT = {
        has_character_flag = is_temujin
        has_landed_title = e_mongol_empire
        demesne_size = 1
      }
      FROM = {
        has_landed_title = e_china_west_governor
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_nomadic = no
        NOT = {
          is_tribal = yes
        }
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_tribal = yes
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
              holding_type = tribal
            }
          }
        }
      }
    }
  }
}
dejure_county_claim = {
  name = CB_NAME_DEJURECLAIM
  war_name = WAR_NAME_DEJURECLAIM
  sprite = 16
  truce_days = 3650
  hostile_against_others = yes
  is_permanent = yes
  check_all_titles = yes
  press_claim = yes
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  infamy_modifier = 0.5
  sort_priority = 700
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use_title = {
    tier = count
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
    OR = {
      kingdom = {
        holder = ROOT
      }
      empire = {
        holder = ROOT
      }
      dejure_liege_title = {
        holder = ROOT
      }
    }
    NOT = {
      OR = {
        ROOT = {
          has_landed_title = PREV
        }
        holder_scope = {
          is_liege_or_above = ROOT
        }
      }
    }
    FROM = {
      OR = {
        holy_order = no
        NOT = {
          religion = ROOT
        }
        NOT = {
          has_dlc = "Sons of Abraham"
        }
        OR = {
          AND = {
            primary_title = {
              title = d_knights_templar
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_templar
            }
          }
          AND = {
            primary_title = {
              title = d_knights_hospitaler
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_hospitaler
            }
          }
          AND = {
            primary_title = {
              title = d_teutonic_order
            }
            ROOT = {
              has_character_modifier = expelled_d_teutonic_order
            }
          }
          AND = {
            primary_title = {
              title = d_jomsvikings
            }
            ROOT = {
              has_character_modifier = expelled_d_jomsvikings
            }
          }
          AND = {
            primary_title = {
              title = d_hashshashin
            }
            ROOT = {
              has_character_modifier = expelled_d_hashshashin
            }
          }
          AND = {
            primary_title = {
              title = d_bektashi
            }
            ROOT = {
              has_character_modifier = expelled_d_bektashi
            }
          }
          AND = {
            primary_title = {
              title = d_haruriyyah
            }
            ROOT = {
              has_character_modifier = expelled_d_haruriyyah
            }
          }
          AND = {
            primary_title = {
              title = d_holy_sepulchre
            }
            ROOT = {
              has_character_modifier = expelled_d_holy_sepulchre
            }
          }
          AND = {
            primary_title = {
              title = d_saint_anthony
            }
            ROOT = {
              has_character_modifier = expelled_d_saint_anthony
            }
          }
          AND = {
            primary_title = {
              title = d_immortals
            }
            ROOT = {
              has_character_modifier = expelled_d_immortals
            }
          }
          AND = {
            primary_title = {
              title = d_zealots
            }
            ROOT = {
              has_character_modifier = expelled_d_zealots
            }
          }
          AND = {
            primary_title = {
              title = d_sky_lords
            }
            ROOT = {
              has_character_modifier = expelled_d_sky_lords
            }
          }
          AND = {
            primary_title = {
              title = d_spirit_guardians
            }
            ROOT = {
              has_character_modifier = expelled_d_spirit_guardians
            }
          }
          AND = {
            primary_title = {
              title = d_warriors_perun
            }
            ROOT = {
              has_character_modifier = expelled_d_warriors_perun
            }
          }
          AND = {
            primary_title = {
              title = d_chosen_perkunas
            }
            ROOT = {
              has_character_modifier = expelled_d_chosen_perkunas
            }
          }
          AND = {
            primary_title = {
              title = d_sons_kaleva
            }
            ROOT = {
              has_character_modifier = expelled_d_sons_kaleva
            }
          }
          AND = {
            primary_title = {
              title = d_huitzilopochtli
            }
            ROOT = {
              has_character_modifier = expelled_d_huitzilopochtli
            }
          }
          AND = {
            primary_title = {
              title = d_knights_santiago
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_santiago
            }
          }
          AND = {
            primary_title = {
              title = d_knights_calatrava
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_calatrava
            }
          }
          AND = {
            primary_title = {
              title = d_saint_addai
            }
            ROOT = {
              has_character_modifier = expelled_d_saint_addai
            }
          }
          AND = {
            primary_title = {
              title = d_zun_warriors
            }
            ROOT = {
              has_character_modifier = expelled_d_zun_warriors
            }
          }
        }
      }
    }
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        holder_scope = {
          tier = count
          is_patrician = no
          NOT = {
            num_of_count_titles = 2
          }
        }
      }
      holder_scope = {
        set_defacto_liege = ROOT
      }
    }
    if = {
      limit = {
        holder_scope = {
          OR = {
            higher_tier_than = count
            num_of_count_titles = 2
            is_patrician = yes
          }
        }
      }
      usurp_title_plus_barony_if_unlanded = {
        target = ROOT
        type = claim
      }
      any_de_jure_vassal_title = {
        limit = {
          has_holder = yes
          NOT = {
            de_facto_liege = PREV
          }
          holder_scope = {
            OR = {
              character = FROM
              is_liege_or_above = FROM
            }
          }
        }
        usurp_title_plus_barony_if_unlanded = {
          target = ROOT
          type = claim
        }
      }
    }
    ROOT = {
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      check_war_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail_title = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
    modifier = {
      factor = 0
      ROOT = {
        same_liege = FROM
      }
      FROM = {
        NOT = {
          any_demesne_title = {
            tier = count
            NOT = {
              title = PREVPREV
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      ROOT = {
        has_character_flag = is_temujin
        has_landed_title = e_mongol_empire
        demesne_size = 1
      }
      FROM = {
        has_landed_title = e_china_west_governor
      }
    }
  }
}
dejure_barony_claim = {
  name = CB_NAME_DEJUREBARONYCLAIM
  war_name = WAR_NAME_DEJUREBARONYCLAIM
  sprite = 16
  truce_days = 3650
  hostile_against_others = yes
  is_permanent = yes
  check_de_jure_tier = COUNT
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  infamy_modifier = 0.5
  sort_priority = 650
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    FROM = {
      NOT = {
        is_vassal_or_below = ROOT
      }
      OR = {
        holy_order = no
        NOT = {
          religion = ROOT
        }
        NOT = {
          has_dlc = "Sons of Abraham"
        }
        OR = {
          AND = {
            primary_title = {
              title = d_knights_templar
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_templar
            }
          }
          AND = {
            primary_title = {
              title = d_knights_hospitaler
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_hospitaler
            }
          }
          AND = {
            primary_title = {
              title = d_teutonic_order
            }
            ROOT = {
              has_character_modifier = expelled_d_teutonic_order
            }
          }
          AND = {
            primary_title = {
              title = d_jomsvikings
            }
            ROOT = {
              has_character_modifier = expelled_d_jomsvikings
            }
          }
          AND = {
            primary_title = {
              title = d_hashshashin
            }
            ROOT = {
              has_character_modifier = expelled_d_hashshashin
            }
          }
          AND = {
            primary_title = {
              title = d_bektashi
            }
            ROOT = {
              has_character_modifier = expelled_d_bektashi
            }
          }
          AND = {
            primary_title = {
              title = d_haruriyyah
            }
            ROOT = {
              has_character_modifier = expelled_d_haruriyyah
            }
          }
          AND = {
            primary_title = {
              title = d_holy_sepulchre
            }
            ROOT = {
              has_character_modifier = expelled_d_holy_sepulchre
            }
          }
          AND = {
            primary_title = {
              title = d_saint_anthony
            }
            ROOT = {
              has_character_modifier = expelled_d_saint_anthony
            }
          }
          AND = {
            primary_title = {
              title = d_immortals
            }
            ROOT = {
              has_character_modifier = expelled_d_immortals
            }
          }
          AND = {
            primary_title = {
              title = d_zealots
            }
            ROOT = {
              has_character_modifier = expelled_d_zealots
            }
          }
          AND = {
            primary_title = {
              title = d_sky_lords
            }
            ROOT = {
              has_character_modifier = expelled_d_sky_lords
            }
          }
          AND = {
            primary_title = {
              title = d_spirit_guardians
            }
            ROOT = {
              has_character_modifier = expelled_d_spirit_guardians
            }
          }
          AND = {
            primary_title = {
              title = d_warriors_perun
            }
            ROOT = {
              has_character_modifier = expelled_d_warriors_perun
            }
          }
          AND = {
            primary_title = {
              title = d_chosen_perkunas
            }
            ROOT = {
              has_character_modifier = expelled_d_chosen_perkunas
            }
          }
          AND = {
            primary_title = {
              title = d_sons_kaleva
            }
            ROOT = {
              has_character_modifier = expelled_d_sons_kaleva
            }
          }
          AND = {
            primary_title = {
              title = d_huitzilopochtli
            }
            ROOT = {
              has_character_modifier = expelled_d_huitzilopochtli
            }
          }
          AND = {
            primary_title = {
              title = d_knights_santiago
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_santiago
            }
          }
          AND = {
            primary_title = {
              title = d_knights_calatrava
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_calatrava
            }
          }
          AND = {
            primary_title = {
              title = d_saint_addai
            }
            ROOT = {
              has_character_modifier = expelled_d_saint_addai
            }
          }
          AND = {
            primary_title = {
              title = d_zun_warriors
            }
            ROOT = {
              has_character_modifier = expelled_d_zun_warriors
            }
          }
        }
      }
    }
  }
  can_use_title = {
    has_holder = yes
    holder_scope = {
      OR = {
        character = ROOT
        is_liege_or_above = ROOT
      }
    }
    any_direct_de_jure_vassal_title = {
      holder_scope = {
        OR = {
          character = FROM
          is_liege_or_above = FROM
        }
        NOR = {
          character = ROOT
          is_liege_or_above = ROOT
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    holder_scope = {
      save_event_target_as = target_taker
    }
    any_direct_de_jure_vassal_title = {
      limit = {
        holder_scope = {
          OR = {
            character = FROM
            is_liege_or_above = FROM
          }
          NOR = {
            character = event_target:target_taker
            is_liege_or_above = event_target:target_taker
            is_liege_or_above = ROOT
          }
        }
      }
      usurp_title_plus_barony_if_unlanded = {
        target = event_target:target_taker
        type = claim
      }
    }
    ROOT = {
      participation_scaled_prestige = 50
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_fail_title = {
    ROOT = {
      prestige = -50
    }
    FROM = {
      participation_scaled_prestige = 25
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 25
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -100
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 75
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 75
  }
}
other_dejure_barony_claim = {
  name = CB_NAME_DEJUREBARONYCLAIM
  war_name = WAR_NAME_OTHER_DEJUREBARONYCLAIM
  sprite = 16
  truce_days = 3650
  is_permanent = no
  can_use = {
    always = no
  }
  is_valid_title = {
    always = no
  }
  on_success = {
  }
  on_success_title = {
  }
  on_fail = {
  }
  on_reverse_demand = {
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
other_dejure_county_claim = {
  name = CB_NAME_DEJURECLAIM
  war_name = WAR_NAME_OTHER_DEJURECLAIM
  sprite = 16
  truce_days = 3650
  hostile_against_others = yes
  is_permanent = yes
  other_de_jure_claim = yes
  press_claim = yes
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  infamy_modifier = 0.3
  sort_priority = 700
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    NOT = {
      character = ROOT
    }
    FROM = {
      OR = {
        holy_order = no
        NOT = {
          religion = ROOT
        }
        NOT = {
          has_dlc = "Sons of Abraham"
        }
        OR = {
          AND = {
            primary_title = {
              title = d_knights_templar
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_templar
            }
          }
          AND = {
            primary_title = {
              title = d_knights_hospitaler
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_hospitaler
            }
          }
          AND = {
            primary_title = {
              title = d_teutonic_order
            }
            ROOT = {
              has_character_modifier = expelled_d_teutonic_order
            }
          }
          AND = {
            primary_title = {
              title = d_jomsvikings
            }
            ROOT = {
              has_character_modifier = expelled_d_jomsvikings
            }
          }
          AND = {
            primary_title = {
              title = d_hashshashin
            }
            ROOT = {
              has_character_modifier = expelled_d_hashshashin
            }
          }
          AND = {
            primary_title = {
              title = d_bektashi
            }
            ROOT = {
              has_character_modifier = expelled_d_bektashi
            }
          }
          AND = {
            primary_title = {
              title = d_haruriyyah
            }
            ROOT = {
              has_character_modifier = expelled_d_haruriyyah
            }
          }
          AND = {
            primary_title = {
              title = d_holy_sepulchre
            }
            ROOT = {
              has_character_modifier = expelled_d_holy_sepulchre
            }
          }
          AND = {
            primary_title = {
              title = d_saint_anthony
            }
            ROOT = {
              has_character_modifier = expelled_d_saint_anthony
            }
          }
          AND = {
            primary_title = {
              title = d_immortals
            }
            ROOT = {
              has_character_modifier = expelled_d_immortals
            }
          }
          AND = {
            primary_title = {
              title = d_zealots
            }
            ROOT = {
              has_character_modifier = expelled_d_zealots
            }
          }
          AND = {
            primary_title = {
              title = d_sky_lords
            }
            ROOT = {
              has_character_modifier = expelled_d_sky_lords
            }
          }
          AND = {
            primary_title = {
              title = d_spirit_guardians
            }
            ROOT = {
              has_character_modifier = expelled_d_spirit_guardians
            }
          }
          AND = {
            primary_title = {
              title = d_warriors_perun
            }
            ROOT = {
              has_character_modifier = expelled_d_warriors_perun
            }
          }
          AND = {
            primary_title = {
              title = d_chosen_perkunas
            }
            ROOT = {
              has_character_modifier = expelled_d_chosen_perkunas
            }
          }
          AND = {
            primary_title = {
              title = d_sons_kaleva
            }
            ROOT = {
              has_character_modifier = expelled_d_sons_kaleva
            }
          }
          AND = {
            primary_title = {
              title = d_huitzilopochtli
            }
            ROOT = {
              has_character_modifier = expelled_d_huitzilopochtli
            }
          }
          AND = {
            primary_title = {
              title = d_knights_santiago
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_santiago
            }
          }
          AND = {
            primary_title = {
              title = d_knights_calatrava
            }
            ROOT = {
              has_character_modifier = expelled_d_knights_calatrava
            }
          }
          AND = {
            primary_title = {
              title = d_saint_addai
            }
            ROOT = {
              has_character_modifier = expelled_d_saint_addai
            }
          }
          AND = {
            primary_title = {
              title = d_zun_warriors
            }
            ROOT = {
              has_character_modifier = expelled_d_zun_warriors
            }
          }
        }
      }
    }
    mercenary = no
  }
  can_use_title = {
    tier = count
    dejure_liege_title = {
      has_holder = yes
      ROOT = {
        has_landed_title = PREV
      }
    }
    holder_scope = {
      NOR = {
        character = ROOT
        character = FROMFROM
        is_liege_or_above = ROOT
        is_liege_or_above = FROMFROM
      }
    }
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      opinion = {
        modifier = pressed_my_claim
        who = PREV
      }
      show_scope_change = no
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  on_success_title = {
    if = {
      limit = {
        holder_scope = {
          tier = count
          NOT = {
            num_of_count_titles = 2
          }
        }
      }
      holder_scope = {
        show_scope_change = no
        set_defacto_liege = ROOT
      }
    }
    if = {
      limit = {
        holder_scope = {
          OR = {
            higher_tier_than = count
            num_of_count_titles = 2
          }
        }
      }
      show_scope_change = no
      usurp_title_plus_barony_if_unlanded = {
        target = ROOT
        type = claim
      }
      any_de_jure_vassal_title = {
        show_scope_change = no
        limit = {
          has_holder = yes
          NOT = {
            de_facto_liege = PREV
          }
          holder_scope = {
            OR = {
              character = FROM
              is_liege_or_above = FROM
            }
          }
        }
        usurp_title_plus_barony_if_unlanded = {
          target = ROOT
          type = claim
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    prestige = -50
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_reverse_demand = {
    prestige = -100
    transfer_scaled_wealth = {
      to = FROM
      value = 4.0
    }
    ROOT = {
      show_scope_change = no
      prestige = -200
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
shia_caliphate_rising = {
  name = CB_NAME_SHIA_CALIPHATE_RISING
  war_name = WAR_NAME_SHIA_CALIPHATE_RISING
  sprite = 8
  truce_days = 365
  hostile_against_others = no
  check_de_jure_tier = KING
  apply_short_occ_mod = no
  can_use = {
    ROOT = {
      has_character_flag = shia_caliphate_pretender
    }
  }
  is_valid_title = {
    ROOT = {
      has_character_flag = shia_caliphate_pretender
    }
    FROM = {
      any_realm_title = {
        de_jure_liege_or_above = PREVPREV
      }
    }
    d_shiite = {
      has_holder = no
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    clr_global_flag = shia_caliphate_revolt_ongoing
    ROOT = {
      piety = 500
      religion_authority = {
        modifier = rise_of_the_shia_caliphate
      }
      clr_character_flag = shia_caliphate_pretender
    }
    FROM = {
      piety = -500
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = tribal_invasion_succ_tip
      hidden_tooltip = {
        d_shiite = {
          usurp_title = {
            target = ROOT
            type = holy_war
          }
        }
        FROM = {
          random_realm_province = {
            limit = {
              de_jure_liege_or_above = PREVPREV
              NOT = {
                religion = ROOT
              }
              religion_group = muslim
            }
            religion = ROOT
          }
          random_realm_province = {
            limit = {
              de_jure_liege_or_above = PREVPREV
              NOT = {
                religion = ROOT
              }
              religion_group = muslim
            }
            religion = ROOT
          }
          random_realm_province = {
            limit = {
              de_jure_liege_or_above = PREVPREV
              NOT = {
                religion = ROOT
              }
              religion_group = muslim
            }
            religion = ROOT
          }
          random_realm_province = {
            limit = {
              de_jure_liege_or_above = PREVPREV
              NOT = {
                religion = ROOT
              }
              religion_group = muslim
            }
            religion = ROOT
          }
          random_realm_province = {
            limit = {
              de_jure_liege_or_above = PREVPREV
              NOT = {
                religion = ROOT
              }
              religion_group = muslim
            }
            religion = ROOT
          }
        }
        ROOT = {
          occupy_minors_of_occupied_settlements = FROM
          gain_all_occupied_titles = {
            who = FROM
            type = revolt
          }
          if = {
            limit = {
              PREV = {
                OR = {
                  has_holder = no
                  holder_scope = {
                    character = FROM
                  }
                }
              }
            }
            usurp_title = {
              target = PREV
              type = revolt
            }
          }
          if = {
            limit = {
              NOT = {
                ROOT = {
                  any_demesne_title = {
                    tier = KING
                  }
                }
              }
            }
            create_title = {
              tier = KING
              landless = no
              temporary = no
              custom_created = yes
              culture = ROOT
              holder = ROOT
              name = SHIA_CUSTOM_FALLBACK
              base_title = PREV
              copy_title_laws = yes
            }
          }
          vassalize_or_take_under_title = {
            title = PREV
            enemy = FROM
            is_religious = yes
            type = revolt
          }
          any_demesne_title = {
            limit = {
              tier = BARON
            }
            remove_holding_modifier = recently_conquered
            refill_holding_levy = yes
          }
          wealth = 500
        }
        if = {
          limit = {
            FROM = {
              is_liege_or_above = ROOT
            }
          }
          FROM = {
            imprison = ROOT
          }
        }
      }
    }
  }
  on_fail = {
    clr_global_flag = shia_caliphate_revolt_ongoing
    FROM = {
      piety = 250
    }
    ROOT = {
      piety = -250
      clr_character_flag = shia_caliphate_pretender
    }
  }
  on_reverse_demand = {
    clr_global_flag = shia_caliphate_revolt_ongoing
    ROOT = {
      piety = -500
      clr_character_flag = shia_caliphate_pretender
      imprison = FROM
    }
    FROM = {
      piety = 250
      participation_scaled_piety = 250
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_piety = 250
      }
    }
  }
  on_attacker_leader_death = {
    clr_global_flag = shia_caliphate_revolt_ongoing
    ROOT = {
      clr_character_flag = shia_caliphate_pretender
    }
    end_war = invalid
  }
  on_invalidation = {
    clr_global_flag = shia_caliphate_revolt_ongoing
  }
  attacker_ai_victory_worth = {
    factor = 200
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
depose_antipope = {
  name = CB_NAME_DEPOSE_ANTIPOPE
  war_name = WAR_NAME_DEPOSE_ANTIPOPE
  sprite = 29
  truce_days = 3650
  is_permanent = yes
  can_ask_to_join_war = yes
  defender_unoccupied_warscore = yes
  attacker_rel_head_is_ally = yes
  allowed_to_target_tributaries = no
  sort_priority = 750
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      religion = FROM
      OR = {
        religion = catholic
        religion = fraticelli
      }
      rightful_religious_head_scope = {
        NOT = {
          has_claim = k_papal_state
        }
        NOT = {
          has_claim = d_fraticelli
        }
      }
      mercenary = no
    }
    FROM = {
      rightful_religious_head_scope = {
        is_liege_or_above = PREV
        OR = {
          has_claim = k_papal_state
          has_claim = d_fraticelli
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      religion = FROM
      OR = {
        religion = catholic
        religion = fraticelli
      }
      rightful_religious_head_scope = {
        NOT = {
          has_claim = k_papal_state
        }
        NOT = {
          has_claim = d_fraticelli
        }
      }
    }
    FROM = {
      rightful_religious_head_scope = {
        is_liege_or_above = PREV
        OR = {
          has_claim = k_papal_state
          has_claim = d_fraticelli
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_invalidation = {
    hidden_tooltip = {
      ROOT = {
        clr_character_flag = flag_antipope_for_coronation
      }
      FROM = {
        clr_character_flag = flag_antipope_for_coronation
      }
    }
  }
  on_success = {
    if = {
      limit = {
        ROOT = {
          has_character_flag = flag_antipope_for_coronation
        }
      }
      ROOT = {
        character_event = {
          id = HF.20220
        }
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_piety = 500
        participation_scaled_prestige = 250
      }
    }
    ROOT = {
      participation_scaled_piety = 500
      participation_scaled_prestige = 250
      religion_authority = {
        modifier = deposed_antipope
        years = 50
      }
      if = {
        limit = {
          rightful_religious_head_scope = {
            ROOT = {
              excommunicated_for = PREV
            }
          }
        }
        excommunicate = no
      }
      rightful_religious_head_scope = {
        opinion = {
          who = ROOT
          modifier = opinion_deposed_antipope
        }
      }
    }
    FROM = {
      piety = -500
      prestige = -250
      rightful_religious_head_scope = {
        remove_claim = k_papal_state
        remove_claim = d_fraticelli
      }
    }
  }
  on_fail = {
    hidden_tooltip = {
      FROM = {
        clr_character_flag = flag_antipope_for_coronation
      }
      ROOT = {
        clr_character_flag = flag_antipope_for_coronation
      }
    }
    ROOT = {
      piety = -250
      prestige = -125
    }
    FROM = {
      piety = 100
      prestige = 50
    }
  }
  on_reverse_demand = {
    hidden_tooltip = {
      FROM = {
        clr_character_flag = flag_antipope_for_coronation
      }
      ROOT = {
        clr_character_flag = flag_antipope_for_coronation
      }
    }
    ROOT = {
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
      piety = -500
      prestige = -250
    }
    FROM = {
      piety = 500
      prestige = 250
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
cb_install_antiking = {
  name = CB_NAME_INSTALL_ANTIKING
  war_name = WAR_NAME_INSTALL_ANTIKING
  sprite = 11
  truce_days = 3650
  major_revolt = yes
  attacker_can_call_allies = no
  attacker_rel_head_is_ally = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      vassal_of = FROM
      religion = FROM
      OR = {
        religion = catholic
        religion = fraticelli
      }
    }
  }
  is_valid_title = {
    NOT = {
      holder_scope = {
        character = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      religion = FROM
      OR = {
        religion = catholic
        religion = fraticelli
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_piety = 500
        participation_scaled_prestige = 250
      }
    }
    ROOT = {
      participation_scaled_piety = 500
      participation_scaled_prestige = 250
      religion_authority = {
        modifier = deposed_antipope
        years = 50
      }
      if = {
        limit = {
          religion = catholic
        }
        k_papal_state = {
          holder_scope = {
            opinion = {
              who = ROOT
              modifier = opinion_deposed_antipope
            }
          }
        }
      }
      if = {
        limit = {
          religion = fraticelli
        }
        d_fraticelli = {
          holder_scope = {
            opinion = {
              who = ROOT
              modifier = opinion_deposed_antipope
            }
          }
        }
      }
    }
    FROM = {
      piety = -500
      prestige = -250
      hidden_tooltip = {
        rightful_religious_head_scope = {
          remove_claim = k_papal_state
          remove_claim = d_fraticelli
        }
      }
      primary_title = {
        usurp_title = {
          target = ROOT
          type = revolt
        }
      }
    }
    if = {
      limit = {
        primary_title = {
          has_law = investiture_law_1
        }
      }
      primary_title = {
        add_law_w_cooldown = investiture_law_0
      }
    }
  }
  on_fail = {
    ROOT = {
      piety = -250
      prestige = -125
      cancel_plot = plot_gain_title
    }
    FROM = {
      piety = 100
      prestige = 50
    }
  }
  on_invalidation = {
    ROOT = {
      cancel_plot = plot_gain_title
    }
  }
  on_reverse_demand = {
    ROOT = {
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
      piety = -500
      prestige = -250
      prisoner = FROM
      cancel_plot = plot_gain_title
    }
    FROM = {
      piety = 500
      prestige = 250
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}

indian_subjugation = {
  name = CB_NAME_PAGAN_SUBJUGATION
  war_name = WAR_NAME_PAGAN_SUBJUGATION
  sprite = 8
  truce_days = 365
  hostile_against_others = yes
  is_permanent = yes
  can_ask_to_join_war = yes
  check_de_jure_tier = KING
  allowed_to_target_tributaries = no
  sort_priority = 1000
  can_use_gui = {
    ROOT = {
      piety = 500
    }
  }
  on_add = {
    ROOT = {
      piety = -500
    }
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  can_use = {
    ROOT = {
      has_dharmic_religion_trigger = yes
      NOT = {
        same_realm = FROM
      }
      NOT = {
        is_liege_or_above = FROM
      }
      has_horde_culture = no
      is_nomadic = no
      mercenary = no
    }
    FROM = {
      NOT = {
        is_offmap_governor = yes
      }
      has_dharmic_religion_trigger = yes
      culture_group = ROOT
      NOT = {
        any_war = {
          defender = {
            character = PREVPREV
          }
          using_cb = indian_subjugation
        }
      }
    }
  }
  can_use_title = {
    ROOT = {
      OR = {
        NOT = {
          has_character_modifier = launched_subjugation
        }
        AND = {
          has_ambition = obj_become_king
          capital_scope = {
            kingdom = {
              title = PREVPREVPREV
            }
          }
        }
      }
    }
    FROM = {
      any_realm_province = {
        de_jure_liege_or_above = PREVPREV
      }
    }
  }
  is_valid_title = {
    FROM = {
      any_realm_province = {
        de_jure_liege_or_above = PREVPREV
      }
    }
  }
  on_add_title = {
    ROOT = {
      if = {
        limit = {
          OR = {
            NOT = {
              has_ambition = obj_become_king
            }
            capital_scope = {
              kingdom = {
                NOT = {
                  title = PREVPREVPREV
                }
              }
            }
          }
        }
        add_character_modifier = {
          name = launched_subjugation
          years = 100
          hidden = yes
        }
      }
    }
  }
  on_success = {
    ROOT = {
      participation_scaled_prestige = 200
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
      }
    }
    FROM = {
      prestige = -200
    }
  }
  on_success_title = {
    if = {
      limit = {
        holder_scope = {
          character = FROM
        }
        NOT = {
          ROOT = {
            tier = EMPEROR
          }
        }
      }
      ROOT = {
        usurp_title = {
          target = PREV
          type = invasion
        }
      }
    }
    if = {
      limit = {
        ROOT = {
          NOT = {
            higher_tier_than = FROM
          }
        }
      }
      FROM = {
        any_demesne_title = {
          limit = {
            tier = DUKE
            OR = {
              title = PREVPREV
              de_jure_liege_or_above = PREVPREV
            }
          }
          ROOT = {
            usurp_title = {
              target = PREV
              type = invasion
            }
          }
        }
      }
    }
    if = {
      limit = {
        ROOT = {
          is_liege_or_above = FROM
        }
      }
      ROOT = {
        set_defacto_liege = ROOT
      }
    }
    custom_tooltip = {
      text = pagan_subjugation_tip
      hidden_tooltip = {
        ROOT = {
          subjugate_or_take_under_title = {
            title = PREV
            enemy = FROM
          }
        }
      }
    }
  }
  on_fail = {
    FROM = {
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    ROOT = {
      prestige = -100
    }
  }
  on_invalidation = {
    ROOT = {
      remove_character_modifier = launched_subjugation
      piety = 500
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 2.0
      }
    }
    FROM = {
      participation_scaled_prestige = 200
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.9
    }
    modifier = {
      factor = 0
      ROOT = {
        has_character_flag = is_temujin
        has_landed_title = e_mongol_empire
        demesne_size = 1
      }
      FROM = {
        has_landed_title = e_china_west_governor
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        NOT = {
          is_tribal = yes
        }
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_tribal = yes
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
              holding_type = tribal
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_nomadic = no
        NOT = {
          is_tribal = yes
        }
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      FROM = {
        is_nomadic = yes
      }
      ROOT = {
        is_tribal = yes
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
              holding_type = tribal
            }
          }
        }
      }
    }
  }
}
manifest_destiny_invasion = {
  name = CB_NAME_INVASION
  war_name = WAR_NAME_INVASION
  sprite = 8
  truce_days = 3650
  hostile_against_others = yes
  is_permanent = yes
  is_holy_war = yes
  can_ask_to_join_war = yes
  check_de_jure_tier = KING
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      OR = {
        ai = yes
        multiplayer = no
        NOT = {
          has_game_rule = {
            name = multiplayer_invasions
            value = off
          }
        }
      }
      OR = {
        AND = {
          dynasty = 613
          NOT = {
            year = 1200
          }
        }
        dynasty = 800
      }
    }
    ROOT = {
      NOT = {
        is_liege_or_above = FROM
      }
      mercenary = no
    }
  }
  can_use_title = {
    empire = {
      OR = {
        title = e_persia
        title = e_byzantium
        title = e_arabia
      }
    }
    FROM = {
      num_of_realm_counties = {
        value = 3
        title = PREV
      }
    }
    any_direct_de_jure_vassal_title = {
      any_direct_de_jure_vassal_title = {
        OR = {
          holder_scope = {
            OR = {
              character = ROOT
              is_liege_or_above = ROOT
            }
          }
          location = {
            any_neighbor_province = {
              owner = {
                OR = {
                  character = ROOT
                  is_liege_or_above = ROOT
                }
              }
            }
          }
        }
      }
    }
  }
  is_valid = {
    always = yes
  }
  is_valid_title = {
    FROM = {
      any_realm_title = {
        de_jure_liege_or_above = PREVPREV
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 200
      hidden_tooltip = {
        if = {
          limit = {
            has_nickname = no
          }
          random_list = {
            10 = {
              give_nickname = nick_the_great
            }
            10 = {
              give_nickname = nick_the_magnificent
            }
            10 = {
              give_nickname = nick_the_glorious
            }
            10 = {
              give_nickname = nick_the_conqueror
            }
          }
        }
      }
      participation_scaled_prestige = 200
      if = {
        limit = {
          uses_decadence = yes
          FROM = {
            NOT = {
              uses_decadence = yes
            }
          }
        }
        participation_scaled_decadence = -20
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
        if = {
          limit = {
            uses_decadence = yes
            FROM = {
              NOT = {
                uses_decadence = yes
              }
            }
          }
          participation_scaled_decadence = -20
        }
      }
    }
    FROM = {
      prestige = -200
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = other_invasion_succ_tip
      hidden_tooltip = {
        ROOT = {
          vassalize_or_take_under_title_destroy_duchies = {
            title = PREV
            enemy = FROM
            is_crusade = yes
            type = invasion
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    FROM = {
      prestige = 100
    }
    FROM = {
      if = {
        limit = {
          has_dlc = "Legacy of Rome"
          OR = {
            has_landed_title = e_byzantium
            has_landed_title = e_roman_empire
          }
          OR = {
            religion_group = christian
            religion = hellenic_pagan
            religion = hellenic_pagan_reformed
          }
        }
        hidden_tooltip = {
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    ROOT = {
      prestige = -200
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
      if = {
        limit = {
          NOT = {
            any_liege = {
              dynasty = PREV
            }
          }
        }
        decadence = 10
      }
    }
    FROM = {
      prestige = 200
      if = {
        limit = {
          has_dlc = "Legacy of Rome"
          OR = {
            has_landed_title = e_byzantium
            has_landed_title = e_roman_empire
          }
          OR = {
            religion_group = christian
            religion = hellenic_pagan
            religion = hellenic_pagan_reformed
          }
        }
        hidden_tooltip = {
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
      participation_scaled_prestige = 200
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = 100
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 150
  }
  ai_will_do = {
    factor = 10
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
  }
}
cb_decadence_usurption = {
  name = CB_NAME_DECADENCE_USURPTION
  war_name = WAR_NAME_DECADENCE_USURPTION
  sprite = 11
  truce_days = 3650
  is_permanent = yes
  allowed_to_target_tributaries = no
  can_use = {
    ROOT = {
      religion_group = muslim
    }
    FROM = {
      religion_group = muslim
      trait = decadent
      dynasty = ROOT
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          ROOT = {
            is_liege_or_above = PREV
          }
        }
      }
    }
    ROOT = {
      mercenary = no
    }
  }
  is_valid = {
    FROM = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          ROOT = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      participation_scaled_piety = 500
      participation_scaled_prestige = 250
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_piety = 500
        participation_scaled_prestige = 250
      }
    }
    FROM = {
      prisoner = ROOT
    }
  }
  on_success_title = {
    usurp_title_plus_barony_if_unlanded = {
      target = ROOT
      type = invasion
    }
  }
  on_fail = {
    ROOT = {
      piety = -250
      prestige = -125
    }
    FROM = {
      piety = 100
      prestige = 50
    }
  }
  on_reverse_demand = {
    ROOT = {
      transfer_scaled_wealth = {
        to = FROM
        value = 2.0
      }
      piety = -500
      prestige = -250
    }
    FROM = {
      piety = 500
      prestige = 250
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
rivalry_cb = {
  name = CB_NAME_RIVALRY
  war_name = WAR_NAME_RIVALRY
  sprite = 7
  truce_days = 3650
  is_permanent = yes
  can_ask_to_join_war = no
  allowed_to_target_tributaries = no
  defender_unoccupied_warscore = yes
  sort_priority = 900
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      is_rival = FROM
    }
    FROM = {
      NOT = {
        has_opinion_modifier = {
          who = ROOT
          modifier = opinion_humiliated_rival
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      is_rival = FROM
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 250
      }
    }
    ROOT = {
      participation_scaled_prestige = 250
      if = {
        limit = {
          ai = no
          FROM = {
            any_sibling = {
              character = ROOT
            }
          }
        }
        set_character_flag = achievement_sibling_rival_war
      }
      remove_opinion = {
        who = FROM
        modifier = opinion_humiliated_rival
      }
    }
    FROM = {
      prestige = -250
      imprison = ROOT
      opinion = {
        modifier = opinion_humiliated_rival
        who = ROOT
        years = 150
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -125
    }
    FROM = {
      prestige = 50
    }
  }
  on_reverse_demand = {
    FROM = {
      participation_scaled_prestige = 250
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 250
      }
    }
    ROOT = {
      prestige = -250
      imprison = FROM
      opinion = {
        modifier = opinion_humiliated_rival
        who = FROM
        years = 150
      }
    }
    FROM = {
      remove_opinion = {
        who = ROOT
        modifier = opinion_humiliated_rival
      }
      if = {
        limit = {
          ai = no
          ROOT = {
            any_sibling = {
              character = PREVPREV
            }
          }
        }
        set_character_flag = achievement_sibling_rival_war
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}

free_tributary_cb = {
  name = CB_NAME_FREE_TRIBUTARY
  war_name = WAR_NAME_FREE_TRIBUTARY
  sprite = 25
  truce_days = 365
  is_permanent = yes
  hostile_against_others = yes
  can_ask_to_join_war = no
  is_independence = yes
  sort_priority = 1100
  can_use = {
    ROOT = {
      OR = {
        AND = {
          is_tributary = yes
          OR = {
            AND = {
              has_dlc = "Horse Lords"
              OR = {
                is_tributary = {
                  type = nomadic
                }
                is_tributary = {
                  type = default
                }
              }
            }
            AND = {
              has_dlc = "Jade Dragon"
              OR = {
                is_tributary = {
                  type = permanent
                }
                is_tributary = {
                  type = offmap
                }
              }
            }
          }
          suzerain = {
            OR = {
              character = FROM
              any_liege = {
                character = FROM
              }
            }
          }
        }
        any_vassal = {
          is_tributary = yes
          OR = {
            AND = {
              has_dlc = "Horse Lords"
              OR = {
                is_tributary = {
                  type = nomadic
                }
                is_tributary = {
                  type = default
                }
              }
            }
            AND = {
              has_dlc = "Jade Dragon"
              OR = {
                is_tributary = {
                  type = permanent
                }
                is_tributary = {
                  type = offmap
                }
              }
            }
          }
          suzerain = {
            OR = {
              character = FROM
              any_liege = {
                character = FROM
              }
            }
          }
        }
      }
    }
  }
  can_use_gui = {
    check_if_crusader_trigger = yes
    ROOT = {
      conditional_tooltip = {
        trigger = {
          is_decision_potential = tributary_independence_china
        }
        NOT = {
          is_decision_allowed = tributary_independence_china
        }
      }
      conditional_tooltip = {
        trigger = {
          is_decision_potential = tributary_independence_normal
        }
        NOT = {
          is_decision_allowed = tributary_independence_normal
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        AND = {
          is_tributary = yes
          suzerain = {
            OR = {
              character = FROM
              any_liege = {
                character = FROM
              }
            }
          }
        }
        any_vassal = {
          is_tributary = yes
          suzerain = {
            OR = {
              character = FROM
              any_liege = {
                character = FROM
              }
            }
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    FROM = {
      show_scope_change = no
      prestige = -100
    }
    ROOT = {
      show_scope_change = no
      prestige = 100
      if = {
        limit = {
          is_tributary = yes
          suzerain = {
            OR = {
              character = FROM
              any_liege = {
                character = FROM
              }
            }
          }
        }
        suzerain = {
          remove_tributary = PREV
        }
      }
      any_vassal = {
        limit = {
          is_tributary = yes
          suzerain = {
            OR = {
              character = FROM
              any_liege = {
                character = FROM
              }
            }
          }
        }
        suzerain = {
          remove_tributary = PREV
        }
      }
    }
  }
  on_fail = {
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
    FROM = {
      show_scope_change = no
      prestige = 100
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -100
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      show_scope_change = no
      prestige = 100
    }
  }
  on_attacker_leader_death = {
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
    modifier = {
      factor = 1.5
      FROM = {
        trait = proud
      }
    }
    modifier = {
      factor = 1.5
      FROM = {
        trait = brave
      }
    }
    modifier = {
      factor = 1.5
      FROM = {
        trait = greedy
      }
    }
    modifier = {
      factor = 2
      FROM = {
        tier = KING
      }
    }
    modifier = {
      factor = 0.8
      ROOT = {
        relative_power = {
          who = FROM
          power = 1.2
        }
      }
    }
    modifier = {
      factor = 0.8
      ROOT = {
        relative_power = {
          who = FROM
          power = 1.5
        }
      }
    }
    modifier = {
      factor = 0.75
      ROOT = {
        relative_power = {
          who = FROM
          power = 2.0
        }
      }
    }
    modifier = {
      factor = 0.75
      ROOT = {
        relative_power = {
          who = FROM
          power = 2.5
        }
      }
    }
    modifier = {
      factor = 0.75
      ROOT = {
        relative_power = {
          who = FROM
          power = 3
        }
      }
    }
    modifier = {
      factor = 0.7
      ROOT = {
        relative_power = {
          who = FROM
          power = 4
        }
      }
    }
    modifier = {
      factor = 0.7
      ROOT = {
        relative_power = {
          who = FROM
          power = 5
        }
      }
    }
    modifier = {
      factor = 0.7
      ROOT = {
        relative_power = {
          who = FROM
          power = 6
        }
      }
    }
    modifier = {
      factor = 0.4
      ROOT = {
        relative_power = {
          who = FROM
          power = 8
        }
      }
    }
    modifier = {
      factor = 0.1
      ROOT = {
        relative_power = {
          who = FROM
          power = 10
        }
      }
    }
    modifier = {
      factor = 5
      ROOT = {
        distance_from_realm = {
          who = FROM
          value = 20
        }
      }
    }
    modifier = {
      factor = 5
      ROOT = {
        distance_from_realm = {
          who = FROM
          value = 40
        }
      }
    }
    modifier = {
      factor = 5
      ROOT = {
        distance_from_realm = {
          who = FROM
          value = 80
        }
      }
    }
    modifier = {
      factor = 5
      ROOT = {
        distance_from_realm = {
          who = FROM
          value = 120
        }
      }
    }
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 1.5
    }
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
    modifier = {
      factor = 4
      ROOT = {
        trait = greedy
      }
    }
    modifier = {
      factor = 2
      OR = {
        ROOT = {
          is_nomadic = yes
        }
        FROM = {
          is_nomadic = no
        }
      }
    }
  }
}
cb_install_khan = {
  name = CB_NAME_INSTALLKHAN
  war_name = WAR_NAME_INSTALLKHAN
  sprite = 12
  truce_days = 3650
  is_revolt_cb = no
  can_call_vassals = yes
  attacker_can_call_allies = no
  major_revolt = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    has_dlc = "Horse Lords"
    ROOT = {
      is_nomadic = yes
    }
  }
  is_valid = {
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
      any_demesne_title = {
        tier = count
      }
    }
    FROM = {
      any_demesne_title = {
        NOT = {
          lower_tier_than = ROOT
        }
        temporary = no
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    FROM = {
      any_demesne_title = {
        limit = {
          tier = EMPEROR
        }
        gain_title = {
          target = ROOT
          type = faction_demand
        }
      }
      death = {
        death_reason = death_execution
        killer = ROOT
      }
    }
    ROOT = {
      participation_scaled_prestige = 250
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 250
      }
    }
  }
  on_fail = {
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 50
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  on_defender_leader_death = {
    hidden_tooltip = {
      any_attacker = {
        letter_event = {
          id = 251
        }
      }
    }
    end_war = invalid
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
nomad_dispute = {
  name = CB_NAME_DISPUTE
  war_name = CB_NAME_DISPUTE
  sprite = 16
  truce_days = 1095
  hostile_against_others = yes
  is_permanent = yes
  check_all_titles = yes
  can_ask_to_join_war = no
  allow_distant = yes
  allowed_to_target_tributaries = no
  sort_priority = 700
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    has_dlc = "Horse Lords"
    FROM = {
      is_nomadic = yes
    }
    ROOT = {
      is_nomadic = yes
      same_realm = FROM
      has_feud_with = FROM
    }
    ROOT = {
      mercenary = no
    }
  }
  can_use_title = {
    tier = count
    location = {
      NOT = {
        num_of_settlements = 1
      }
    }
    FROM = {
      has_landed_title = PREV
    }
  }
  is_valid_title = {
    location = {
      NOT = {
        num_of_settlements = 1
      }
    }
    FROM = {
      has_landed_title = PREV
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    usurp_title_plus_barony_if_unlanded = {
      target = ROOT
      type = invasion
    }
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 100
      participation_scaled_piety = 50
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        participation_scaled_piety = 50
      }
    }
  }
  on_fail_title = {
    ROOT = {
      show_scope_change = no
      prestige = -100
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      show_scope_change = no
      participation_scaled_prestige = 100
      participation_scaled_piety = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
        participation_scaled_piety = 50
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 2
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
  }
}
cb_liberate_nomad_duchy = {
  name = CB_NAME_LIBERATE_NOMAD
  war_name = WAR_NAME_LIBERATE_NOMAD
  sprite = 8
  truce_days = 3650
  is_permanent = yes
  check_de_jure_tier = DUKE
  allowed_to_target_tributaries = no
  infamy_modifier = 0.75
  sort_priority = 810
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    FROM = {
      is_nomadic = yes
    }
    ROOT = {
      is_nomadic = no
      NOT = {
        pacifist = yes
      }
      NOT = {
        same_realm = FROM
      }
      mercenary = no
    }
  }
  can_use_title = {
    any_direct_de_jure_vassal_title = {
      OR = {
        holder_scope = {
          OR = {
            character = ROOT
            is_liege_or_above = ROOT
          }
        }
        location = {
          any_neighbor_province = {
            has_owner = yes
            owner = {
              OR = {
                character = ROOT
                is_liege_or_above = ROOT
              }
            }
          }
        }
      }
    }
    any_de_jure_vassal_title = {
      tier = COUNT
      OR = {
        holder_scope = {
          character = FROM
        }
        holder_scope = {
          any_liege = {
            character = FROM
          }
        }
      }
      OR = {
        location = {
          NOT = {
            region = world_steppe
          }
        }
        location = {
          any_province_holding = {
            OR = {
              holding_type = city
              holding_type = castle
              holding_type = tribal
            }
          }
        }
      }
    }
  }
  is_valid = {
    FROM = {
      is_nomadic = yes
    }
    ROOT = {
      is_nomadic = no
      NOT = {
        pacifist = yes
      }
      NOT = {
        same_realm = FROM
      }
      mercenary = no
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      show_scope_change = no
      participation_scaled_prestige = 200
      if = {
        limit = {
          uses_decadence = yes
        }
        participation_scaled_decadence = -10
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
        if = {
          limit = {
            uses_decadence = yes
          }
          participation_scaled_decadence = -10
        }
      }
    }
    FROM = {
      show_scope_change = no
      prestige = -200
    }
  }
  on_success_title = {
    check_holy_order_donation_effect = yes
    custom_tooltip = {
      text = liberate_nomad_cb_succ_tip
      hidden_tooltip = {
        ROOT = {
          vassalize_or_take_under_title = {
            title = PREV
            enemy = FROM
            anti_nomad = yes
            type = invasion
          }
        }
      }
    }
  }
  on_fail = {
    ROOT = {
      show_scope_change = no
      prestige = -200
    }
  }
  on_reverse_demand = {
    ROOT = {
      show_scope_change = no
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
      prestige = -200
    }
    FROM = {
      participation_scaled_prestige = 300
      if = {
        limit = {
          uses_decadence = yes
        }
        participation_scaled_decadence = -10
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 300
        if = {
          limit = {
            uses_decadence = yes
          }
          participation_scaled_decadence = -10
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.1
      has_dlc = "Holy Fury"
      ROOT = {
        is_feudal = yes
        OR = {
          religion = catholic
          religion = fraticelli
        }
        NOR = {
          trait = crowned_by_priest
          trait = crowned_by_bishop
          trait = crowned_by_pope
          trait = crowned_by_myself
        }
      }
    }
    modifier = {
      factor = 0
      ROOT = {
        NOT = {
          is_tribal = yes
        }
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
            }
          }
        }
      }
    }
    modifier = {
      factor = 0
      ROOT = {
        is_tribal = yes
      }
      NOT = {
        any_direct_de_jure_vassal_title = {
          any_direct_de_jure_vassal_title = {
            OR = {
              holding_type = castle
              holding_type = city
              holding_type = tribal
            }
          }
        }
      }
    }
  }
}
cb_minor_clan_revolt = {
  name = CB_NAME_MINOR_CLAN_REVOLT
  war_name = WAR_NAME_MINOR_CLAN_REVOLT
  sprite = 16
  truce_days = 365
  hostile_against_others = no
  is_permanent = yes
  check_all_titles = yes
  press_claim = yes
  attacker_can_call_allies = no
  defender_can_call_allies = no
  can_ask_to_join_war = no
  is_independence = yes
  can_use = {
    ROOT = {
      primary_title = {
        temporary = yes
      }
      war = no
      NOT = {
        is_liege_or_above = FROM
      }
      mercenary = no
    }
  }
  can_use_title = {
    tier = count
  }
  is_valid_title = {
    OR = {
      FROM = {
        has_landed_title = PREV
      }
      holder_scope = {
        is_liege_or_above = FROM
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success_title = {
    usurp_title_plus_barony_if_unlanded = {
      target = ROOT
      type = revolt
    }
    ROOT = {
      primary_title = {
        set_title_nomad = {
          title = THIS
          status = no
        }
      }
      set_government_type = feudal_government
    }
    ROOT = {
      set_government_type = nomadic_government
      set_defacto_liege = FROM
      hidden_tooltip = {
        remove_opinion = {
          who = FROM
          modifier = opinion_evil_tyrant
        }
      }
    }
    FROM = {
      prestige = -100
    }
  }
  on_fail_title = {
    FROM = {
      prestige = 10
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
      }
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
      }
    }
  }
  on_reverse_demand = {
    FROM = {
      prestige = 20
      hidden_tooltip = {
        opinion = {
          modifier = opinion_rebel_traitor
          who = ROOT
          months = 1200
        }
        add_character_modifier = {
          name = crushed_revolt
          days = 3650
        }
      }
    }
    ROOT = {
      clear_wealth = yes
      imprison = FROM
      hidden_tooltip = {
        add_character_modifier = {
          name = broken_spirit
          days = -1
        }
      }
    }
  }
  on_attacker_leader_death = {
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
nomad_subjugation = {
  name = CB_NAME_PAGAN_SUBJUGATION
  war_name = WAR_NAME_PAGAN_SUBJUGATION
  sprite = 8
  truce_days = 365
  is_permanent = yes
  can_ask_to_join_war = yes
  allowed_to_target_tributaries = no
  defender_unoccupied_warscore = yes
  sort_priority = 1100
  can_use_gui = {
    OR = {
      ROOT = {
        higher_tier_than = king
      }
      NOT = {
        FROM = {
          tier = emperor
        }
      }
    }
    FROM = {
      is_nomadic = no
      OR = {
        AND = {
          is_tribal = yes
          ROOT = {
            population = 2500
          }
        }
        ROOT = {
          population = 10000
        }
        has_opinion_modifier = {
          modifier = declared_independence_nomad
          who = FROM
        }
      }
    }
    ROOT = {
      OR = {
        prestige = 500
        has_opinion_modifier = {
          modifier = declared_independence_nomad
          who = FROM
        }
      }
    }
  }
  can_use = {
    ROOT = {
      OR = {
        ai = yes
        multiplayer = no
        NOT = {
          has_game_rule = {
            name = multiplayer_invasions
            value = off
          }
        }
      }
      is_nomadic = yes
      NOT = {
        same_realm = FROM
      }
      NOT = {
        is_liege_or_above = FROM
      }
      mercenary = no
      OR = {
        NOT = {
          has_character_modifier = launched_subjugation
        }
        has_opinion_modifier = {
          modifier = declared_independence_nomad
          who = FROM
        }
      }
    }
    FROM = {
      in_revolt = no
      is_nomadic = no
      NOT = {
        is_offmap_governor = yes
      }
      NOT = {
        any_war = {
          defender = {
            character = PREVPREV
          }
          OR = {
            using_cb = nomad_subjugation
            using_cb = pagan_subjugation
          }
        }
      }
    }
    OR = {
      ROOT = {
        ai = no
      }
      FROM = {
        any_realm_title = {
          tier = COUNT
          count = 5
        }
      }
    }
  }
  on_add = {
    ROOT = {
      if = {
        limit = {
          NOT = {
            has_opinion_modifier = {
              modifier = declared_independence_nomad
              who = FROM
            }
          }
        }
        prestige = -500
        add_character_modifier = {
          name = launched_subjugation
          years = 100
          hidden = yes
        }
      }
    }
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    hidden_tooltip = {
      ROOT = {
        if = {
          limit = {
            has_nickname = no
          }
          FROM = {
            save_event_target_as = nickname_target
          }
          ROOT = {
            save_event_target_as = nickname_receiver
          }
          random_list = {
            2 = {
              give_nickname = nick_the_eastern_wind
            }
            5 = {
              give_nickname = nick_the_despoiler
            }
            5 = {
              give_nickname = nick_the_bane_of_realmname
              modifier = {
                factor = 0
                event_target:nickname_target = {
                  is_nomadic = yes
                }
              }
              modifier = {
                factor = 0
                event_target:nickname_target = {
                  culture = ROOT
                }
              }
            }
            5 = {
              give_nickname = nick_the_culture_marauder
              modifier = {
                factor = 0
                event_target:nickname_target = {
                  is_nomadic = yes
                }
              }
              modifier = {
                factor = 0
                event_target:nickname_target = {
                  culture = ROOT
                }
              }
            }
            100 = {
            }
          }
        }
      }
    }
    ROOT = {
      piety = 100
      participation_scaled_prestige = 100
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    FROM = {
      piety = -100
      prestige = -100
      if = {
        limit = {
          is_reformed_religion = ROOT
          controls_religion = no
        }
        religion = ROOT
      }
      custom_tooltip = {
        text = tribal_subjugation_tip
      }
      hidden_tooltip = {
        opinion = {
          modifier = opinion_subjugated
          who = ROOT
        }
        any_vassal = {
          opinion = {
            modifier = opinion_subjugated
            who = ROOT
          }
        }
        any_demesne_title = {
          limit = {
            higher_tier_than = ROOT
            NOT = {
              controls_religion = yes
            }
          }
          ROOT = {
            grant_title_no_opinion = {
              target = PREV
              type = invasion
            }
          }
          add_pressed_claim = PREV
        }
        any_demesne_title = {
          limit = {
            tier = ROOT
            NOT = {
              controls_religion = yes
            }
          }
          ROOT = {
            grant_title_no_opinion = {
              target = PREV
              type = invasion
            }
          }
          add_pressed_claim = PREV
        }
        if = {
          limit = {
            NOT = {
              any_demesne_title = {
                controls_religion = yes
              }
            }
          }
          set_defacto_liege = ROOT
          break = yes
        }
        any_vassal = {
          set_defacto_liege = ROOT
        }
        any_demesne_title = {
          limit = {
            NOT = {
              controls_religion = yes
            }
          }
          ROOT = {
            grant_title_no_opinion = {
              target = PREV
              type = invasion
            }
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    FROM = {
      piety = 50
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    ROOT = {
      piety = -100
    }
  }
  on_invalidation = {
    if = {
      limit = {
        NOT = {
          has_opinion_modifier = {
            modifier = declared_independence_nomad
            who = FROM
          }
        }
      }
      ROOT = {
        remove_character_modifier = launched_subjugation
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      piety = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 2.0
      }
    }
    FROM = {
      piety = 100
      if = {
        limit = {
          has_dlc = "Legacy of Rome"
          OR = {
            has_landed_title = e_byzantium
            has_landed_title = e_roman_empire
          }
          OR = {
            religion_group = christian
            religion = hellenic_pagan
            religion = hellenic_pagan_reformed
          }
        }
        hidden_tooltip = {
          character_event = {
            id = LoR.30
            days = 12
          }
        }
      }
      participation_scaled_prestige = 100
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 10
    modifier = {
      factor = 0
      ROOT = {
        has_character_flag = is_temujin
        has_landed_title = e_mongol_empire
        demesne_size = 1
      }
      FROM = {
        has_landed_title = e_china_west_governor
      }
    }
  }
}

nomad_expansion = {
  name = CB_NAME_NOMAD_EXPANSION
  war_name = WAR_NAME_NOMAD_EXPANSION
  sprite = 8
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  check_de_jure_tier = DUKE
  allowed_to_target_tributaries = no
  sort_priority = 800
  can_use_gui = {
    ROOT = {
      prestige = 300
      population_factor = 0.5
    }
    FROM = {
      OR = {
        is_nomadic = yes
        AND = {
          is_tribal = yes
          ROOT = {
            population = 5000
          }
        }
        ROOT = {
          population = 15000
        }
      }
    }
  }
  on_add = {
    ROOT = {
      prestige = -300
    }
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  can_use = {
    ROOT = {
      is_nomadic = yes
      NOT = {
        same_realm = FROM
      }
      mercenary = no
    }
  }
  can_use_title = {
    any_direct_de_jure_vassal_title = {
      OR = {
        holder_scope = {
          OR = {
            character = ROOT
            is_liege_or_above = ROOT
          }
        }
        location = {
          any_neighbor_province = {
            has_owner = yes
            owner = {
              OR = {
                character = ROOT
                is_liege_or_above = ROOT
              }
            }
          }
        }
      }
    }
  }
  is_valid = {
    ROOT = {
      NOR = {
        pays_tribute_to = FROM
        any_liege = {
          OR = {
            pays_tribute_to = FROM
            FROM = {
              pays_tribute_to = PREV
            }
          }
        }
      }
      is_nomadic = yes
      NOT = {
        same_realm = FROM
      }
    }
  }
  on_success = {
    ROOT = {
      if = {
        limit = {
          has_nickname = no
        }
        FROM = {
          save_event_target_as = nickname_target
        }
        ROOT = {
          save_event_target_as = nickname_receiver
        }
        random_list = {
          5 = {
            give_nickname = nick_the_eastern_wind
          }
          5 = {
            give_nickname = nick_the_despoiler
          }
          5 = {
            give_nickname = nick_the_culture_marauder
            modifier = {
              factor = 0
              event_target:nickname_target = {
                is_nomadic = yes
              }
            }
            modifier = {
              factor = 0
              event_target:nickname_target = {
                culture = ROOT
              }
            }
          }
          5 = {
            give_nickname = nick_the_bane_of_realmname
            modifier = {
              factor = 0
              event_target:nickname_target = {
                is_nomadic = yes
              }
            }
            modifier = {
              factor = 0
              event_target:nickname_target = {
                culture = ROOT
              }
            }
          }
          5 = {
            give_nickname = nick_the_slayer_of_culture
            modifier = {
              factor = 0
              event_target:nickname_target = {
                culture = ROOT
              }
            }
          }
          5 = {
            give_nickname = nick_the_scourge_of_god
            modifier = {
              factor = 0
              event_target:nickname_target = {
                religion = ROOT
              }
            }
          }
          100 = {
          }
        }
      }
      if = {
        limit = {
          uses_decadence = yes
        }
        participation_scaled_decadence = -10
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 200
        if = {
          limit = {
            uses_decadence = yes
          }
          participation_scaled_decadence = -10
        }
      }
    }
    FROM = {
      prestige = -200
    }
  }
  on_success_title = {
    custom_tooltip = {
      text = pagan_subjugation_tip
      hidden_tooltip = {
        ROOT = {
          subjugate_or_take_under_title = {
            title = PREV
            enemy = FROM
          }
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -200
    }
  }
  on_reverse_demand = {
    ROOT = {
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
      prestige = -200
    }
    FROM = {
      participation_scaled_prestige = 300
      if = {
        limit = {
          uses_decadence = yes
        }
        participation_scaled_decadence = -10
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 300
        if = {
          limit = {
            uses_decadence = yes
          }
          participation_scaled_decadence = -10
        }
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
  ai_will_do = {
    factor = 2
    modifier = {
      factor = 0.1
      ROOT = {
        OR = {
          dynasty = 613
          dynasty = 800
          primary_title = {
            title = "e_il-khanate"
          }
        }
      }
      OR = {
        empire = {
          NOT = {
            OR = {
              title = e_persia
              title = e_byzantium
              title = e_arabia
            }
          }
        }
        FROM = {
          primary_title = {
            title = e_golden_horde
          }
          NOT = {
            year = 1300
          }
        }
      }
    }
    modifier = {
      factor = 0.1
      ROOT = {
        primary_title = {
          title = e_golden_horde
        }
      }
      OR = {
        empire = {
          OR = {
            title = e_persia
            title = e_byzantium
            title = e_arabia
          }
        }
        FROM = {
          primary_title = {
            title = "e_il-khanate"
          }
          NOT = {
            year = 1300
          }
        }
      }
    }
    modifier = {
      factor = 2.0
      OR = {
        culture = persian
        culture = baloch
        culture = afghan
        culture = turkish
      }
      empire = {
        OR = {
          title = e_persia
          title = e_rajastan
        }
      }
    }
    modifier = {
      factor = 0
      ROOT = {
        has_character_flag = is_temujin
        has_landed_title = e_mongol_empire
        demesne_size = 1
      }
      FROM = {
        has_landed_title = e_china_west_governor
      }
    }
  }
}
increase_council_power_war = {
  name = CB_NAME_INCREASE_COUNCIL_POWER
  war_name = WAR_NAME_INCREASE_COUNCIL_POWER
  sprite = 6
  truce_days = 3650
  can_call_allies = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      vassal_of = FROM
    }
  }
  can_use_title = {
    higher_tier_than = BARON
    OR = {
      has_law = law_voting_power_0
      has_law = banish_voting_power_0
      has_law = execution_voting_power_0
      has_law = revoke_title_voting_power_0
      has_law = grant_title_voting_power_0
      has_law = imprison_voting_power_0
      has_law = war_voting_power_0
    }
    is_primary_holder_title = yes
  }
  is_valid = {
    FROM = {
      in_revolt = no
      liege_before_war = {
        in_revolt = no
        liege_before_war = {
          in_revolt = no
        }
      }
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      opinion = {
        modifier = opinion_increased_council_power
        who = FROM
        months = 12
      }
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    any_attacker = {
      limit = {
        NOT = {
          character = ROOT
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_success_title = {
    increase_council_power_effect = yes
    increase_vassal_freedom_effect = yes
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_council_power_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_council_power_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
nomad_humiliate_cb = {
  name = CB_NAME_HUMILIATE
  war_name = WAR_NAME_HUMILIATE
  sprite = 1
  truce_days = 3650
  is_permanent = yes
  hostile_against_others = yes
  can_ask_to_join_war = no
  display_on_map = no
  allowed_to_target_tributaries = no
  defender_unoccupied_warscore = yes
  sort_priority = 815
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    has_dlc = "Horse Lords"
    FROM = {
      is_nomadic = yes
    }
    ROOT = {
      is_nomadic = yes
      mercenary = no
      OR = {
        AND = {
          same_realm = FROM
          has_feud_with = FROM
        }
        FROM = {
          is_nomadic = yes
          independent = yes
        }
      }
    }
    FROM = {
      any_realm_province = {
        any_neighbor_province = {
          OR = {
            AND = {
              has_owner = yes
              owner = {
                OR = {
                  character = ROOT
                  is_liege_or_above = ROOT
                }
              }
            }
            AND = {
              is_land = no
              any_neighbor_province = {
                OR = {
                  AND = {
                    has_owner = yes
                    owner = {
                      OR = {
                        character = ROOT
                        is_liege_or_above = ROOT
                      }
                    }
                  }
                  AND = {
                    is_land = no
                    any_neighbor_province = {
                      owner = {
                        OR = {
                          character = ROOT
                          is_liege_or_above = ROOT
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    ROOT = {
      prestige = 300
      steal_population_scaled = {
        target = FROM
        percentage = 0.25
      }
    }
    FROM = {
      prestige = -300
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      prestige = 100
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      transfer_scaled_wealth = {
        to = FROM
        value = 4.0
      }
    }
    FROM = {
      prestige = 200
    }
  }
  on_attacker_leader_death = {
    end_war = invalid
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
    modifier = {
      factor = 2
      FROM = {
        trait = proud
      }
    }
    modifier = {
      factor = 2
      FROM = {
        trait = brave
      }
    }
    modifier = {
      factor = 2
      FROM = {
        trait = greedy
      }
    }
    modifier = {
      factor = 3
      FROM = {
        tier = KING
      }
    }
    modifier = {
      factor = 0.85
      ROOT = {
        relative_power = {
          who = FROM
          power = 1.2
        }
      }
    }
    modifier = {
      factor = 0.85
      ROOT = {
        relative_power = {
          who = FROM
          power = 1.5
        }
      }
    }
    modifier = {
      factor = 0.8
      ROOT = {
        relative_power = {
          who = FROM
          power = 2.0
        }
      }
    }
    modifier = {
      factor = 0.8
      ROOT = {
        relative_power = {
          who = FROM
          power = 2.5
        }
      }
    }
    modifier = {
      factor = 0.8
      ROOT = {
        relative_power = {
          who = FROM
          power = 3
        }
      }
    }
    modifier = {
      factor = 0.75
      ROOT = {
        relative_power = {
          who = FROM
          power = 4
        }
      }
    }
    modifier = {
      factor = 0.75
      ROOT = {
        relative_power = {
          who = FROM
          power = 5
        }
      }
    }
    modifier = {
      factor = 0.75
      ROOT = {
        relative_power = {
          who = FROM
          power = 6
        }
      }
    }
    modifier = {
      factor = 0.5
      ROOT = {
        relative_power = {
          who = FROM
          power = 8
        }
      }
    }
    modifier = {
      factor = 0.25
      ROOT = {
        relative_power = {
          who = FROM
          power = 10
        }
      }
    }
    modifier = {
      factor = 2
      ROOT = {
        distance_from_realm = {
          who = FROM
          value = 20
        }
      }
    }
    modifier = {
      factor = 2
      ROOT = {
        distance_from_realm = {
          who = FROM
          value = 40
        }
      }
    }
    modifier = {
      factor = 3
      ROOT = {
        distance_from_realm = {
          who = FROM
          value = 80
        }
      }
    }
    modifier = {
      factor = 4
      ROOT = {
        distance_from_realm = {
          who = FROM
          value = 120
        }
      }
    }
  }
  ai_will_do = {
    factor = 1
    modifier = {
      factor = 0.1
    }
    modifier = {
      factor = 0.1
      FROM = {
        OR = {
          is_nomadic = yes
          is_tribal = yes
        }
      }
    }
    modifier = {
      factor = 4
      ROOT = {
        trait = greedy
      }
    }
  }
}
powerful_vassal_takeover_war = {
  name = CB_NAME_POWERFUL_VASSAL_TAKEOVER
  war_name = WAR_NAME_POWERFUL_VASSAL_TAKEOVER
  sprite = 6
  truce_days = 3650
  can_call_allies = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_use_gui = {
    check_if_crusader_trigger = yes
  }
  can_use = {
    ROOT = {
      vassal_of = FROM
    }
  }
  can_use_title = {
    higher_tier_than = BARON
    is_primary_holder_title = yes
  }
  is_valid = {
    FROM = {
      in_revolt = no
      has_character_flag = powerful_vassal_takeover_target
    }
    ROOT = {
      OR = {
        liege = {
          character = PREV
        }
        liege = {
          FROM = {
            is_liege_or_above = PREV
          }
        }
      }
    }
  }
  on_add = {
    hidden_tooltip = {
      fire_haruspicy_event_effect = yes
    }
    if = {
      limit = {
        defender = {
          is_offmap_governor = offmap_china
        }
      }
      attacker = {
        sound_effect = china_angered_emperor
        detract_grace_super_huge_effect = yes
      }
    }
  }
  on_success = {
    any_attacker = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        disband_event_forces = faction_revolters
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
      }
    }
  }
  on_success_title = {
    increase_council_power_effect = yes
    increase_vassal_freedom_effect = yes
    increase_vassal_freedom_effect = yes
    if = {
      limit = {
        has_law = succession_voting_power_0
      }
      add_law_w_cooldown = succession_voting_power_1
    }
    if = {
      limit = {
        NOT = {
          has_law = succ_byzantine_elective
        }
      }
      custom_tooltip = {
        text = overthrow_text
        hidden_tooltip = {
          if = {
            limit = {
              OR = {
                title = e_hre
                has_title_flag = alternate_hre
              }
              NOR = {
                has_law = succ_feudal_elective
                has_law = succ_hre_elective
              }
              has_law = law_voting_power_1
              has_law = banish_voting_power_1
              has_law = execution_voting_power_1
              has_law = revoke_title_voting_power_1
              has_law = grant_title_voting_power_1
              has_law = imprison_voting_power_1
              has_law = war_voting_power_1
            }
            add_law_w_cooldown = succ_hre_elective
          }
          if = {
            limit = {
              NOR = {
                title = e_hre
                has_title_flag = alternate_hre
              }
              NOR = {
                has_law = succ_feudal_elective
                has_law = succ_hre_elective
              }
              has_law = law_voting_power_1
              has_law = banish_voting_power_1
              has_law = execution_voting_power_1
              has_law = revoke_title_voting_power_1
              has_law = grant_title_voting_power_1
              has_law = imprison_voting_power_1
              has_law = war_voting_power_1
            }
            add_law_w_cooldown = succ_feudal_elective
          }
          if = {
            limit = {
              NOT = {
                has_law = succ_gavelkind
              }
              NOR = {
                has_law = succ_feudal_elective
                has_law = succ_hre_elective
              }
              NAND = {
                has_law = succ_feudal_elective
                has_law = law_voting_power_1
                has_law = banish_voting_power_1
                has_law = execution_voting_power_1
                has_law = revoke_title_voting_power_1
                has_law = grant_title_voting_power_1
                has_law = imprison_voting_power_1
                has_law = war_voting_power_1
              }
            }
            add_law_w_cooldown = succ_gavelkind
          }
        }
      }
    }
    holder_scope = {
      clr_character_flag = powerful_vassal_takeover_target
      most_popular_vassal = {
        limit = {
          higher_tier_than = BARON
          is_feudal = yes
          prisoner = no
          NOR = {
            is_inaccessible_trigger = yes
            trait = incapable
            trait = eunuch
          }
          age = 16
          OR = {
            is_female = no
            AND = {
              is_female = yes
              ROOT = {
                has_law = true_cognatic_succession
              }
            }
          }
        }
        usurp_title = {
          target = PREVPREV
          type = faction_demand
        }
        save_event_target_as = new_title_holder
        hidden_tooltip = {
          any_attacker = {
            limit = {
              NOT = {
                character = PREV
              }
            }
            set_character_flag = helped_win_war
          }
        }
        character_event = {
          id = 8226
          days = 1
        }
      }
    }
    hidden_tooltip = {
      check_if_reconquista_finished_effect = yes
      FROM = {
        landless_pope_effect = yes
      }
    }
  }
  on_fail = {
    ROOT = {
      prestige = -100
    }
    FROM = {
      participation_scaled_prestige = 50
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 50
      }
    }
    hidden_tooltip = {
      any_attacker = {
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_powerful_vassal_takeover_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
        clr_character_flag = powerful_vassal_takeover_target
      }
    }
  }
  on_reverse_demand = {
    ROOT = {
      prestige = -200
      prisoner = FROM
    }
    FROM = {
      participation_scaled_prestige = 100
      hidden_tooltip = {
        if = {
          limit = {
            NOT = {
              has_opinion_modifier = {
                modifier = opinion_traitor
                who = ROOT
              }
            }
          }
          opinion = {
            who = ROOT
            modifier = opinion_traitor
          }
        }
      }
    }
    any_defender = {
      limit = {
        NOT = {
          character = FROM
        }
      }
      hidden_tooltip = {
        participation_scaled_prestige = 100
      }
    }
    hidden_tooltip = {
      any_attacker = {
        limit = {
          liege = {
            character = FROM
          }
        }
        prisoner = FROM
        disband_event_forces = faction_revolters
        add_character_modifier = {
          name = faction_powerful_vassal_takeover_ultimatum_timer
          hidden = yes
          duration = 3650
        }
      }
    }
    FROM = {
      hidden_tooltip = {
        disband_event_forces = faction_loyalists
        clr_character_flag = powerful_vassal_takeover_target
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_leon = {
  name = CB_NAME_RECONQUISTA_LEON
  war_name = WAR_NAME_RECONQUISTA_LEON
  diplo_view_region = custom_leon
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_leon
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_leon
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_leon
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_leon
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_leon
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_leon
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_leon
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_leon = {
      save_event_target_as = first_duchy_title
    }
    d_asturias = {
      save_event_target_as = second_duchy_title
    }
    if = {
      limit = {
        k_asturias = {
          is_titular = yes
        }
      }
      k_leon = {
        save_event_target_as = reconquista_kingdom_title
      }
    }
    else = {
      k_asturias = {
        save_event_target_as = reconquista_kingdom_title
      }
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_castille = {
  name = CB_NAME_RECONQUISTA_CASTILLE
  war_name = WAR_NAME_RECONQUISTA_CASTILLE
  diplo_view_region = custom_castille
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_castille
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_castille
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_castille
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_castille
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_castille
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_castille
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_castille
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_castilla = {
      save_event_target_as = first_duchy_title
    }
    d_toledo = {
      save_event_target_as = second_duchy_title
    }
    k_castille = {
      save_event_target_as = reconquista_kingdom_title
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_aragon = {
  name = CB_NAME_RECONQUISTA_ARAGON
  war_name = WAR_NAME_RECONQUISTA_ARAGON
  diplo_view_region = custom_aragon
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_aragon
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_aragon
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_aragon
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_aragon
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_aragon
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_aragon
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_aragon
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_aragon = {
      save_event_target_as = first_duchy_title
    }
    d_barcelona = {
      save_event_target_as = second_duchy_title
    }
    k_aragon = {
      save_event_target_as = reconquista_kingdom_title
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_galicia = {
  name = CB_NAME_RECONQUISTA_GALICIA
  war_name = WAR_NAME_RECONQUISTA_GALICIA
  diplo_view_region = custom_galicia
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_galicia
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_galicia
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_galicia
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_galicia
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_galicia
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_galicia
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_galicia
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_galicia = {
      save_event_target_as = first_duchy_title
    }
    d_porto = {
      save_event_target_as = second_duchy_title
    }
    if = {
      limit = {
        k_spanish_galicia = {
          is_titular = no
        }
      }
      k_spanish_galicia = {
        save_event_target_as = reconquista_kingdom_title
      }
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_beja = {
  name = CB_NAME_RECONQUISTA_BEJA
  war_name = WAR_NAME_RECONQUISTA_BEJA
  diplo_view_region = custom_beja
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_beja
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_beja
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_beja
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_beja
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_beja
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_beja
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_beja
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_beja = {
      save_event_target_as = first_duchy_title
    }
    d_algarve = {
      save_event_target_as = second_duchy_title
    }
    d_balata = {
      save_event_target_as = third_duchy_title
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_granada = {
  name = CB_NAME_RECONQUISTA_GRANADA
  war_name = WAR_NAME_RECONQUISTA_GRANADA
  diplo_view_region = custom_granada
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_granada
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_granada
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_granada
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_granada
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_granada
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_granada
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_granada
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_granada = {
      save_event_target_as = first_duchy_title
    }
    d_sevilla = {
      save_event_target_as = second_duchy_title
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_cordoba = {
  name = CB_NAME_RECONQUISTA_CORDOBA
  war_name = WAR_NAME_RECONQUISTA_CORDOBA
  diplo_view_region = custom_cordoba
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_cordoba
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_cordoba
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_cordoba
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_cordoba
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_cordoba
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_cordoba
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_cordoba
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_cordoba = {
      save_event_target_as = first_duchy_title
    }
    d_badajoz = {
      save_event_target_as = second_duchy_title
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_valencia = {
  name = CB_NAME_RECONQUISTA_VALENCIA
  war_name = WAR_NAME_RECONQUISTA_VALENCIA
  diplo_view_region = custom_valencia
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_valencia
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_valencia
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_valencia
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_valencia
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_valencia
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_valencia
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_valencia
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_valencia = {
      save_event_target_as = first_duchy_title
    }
    d_murcia = {
      save_event_target_as = second_duchy_title
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_navarra = {
  name = CB_NAME_RECONQUISTA_NAVARRA
  war_name = WAR_NAME_RECONQUISTA_NAVARRA
  diplo_view_region = custom_navarra
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_navarra
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_navarra
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                region = custom_navarra
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_navarra
              }
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_navarra
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              is_land = yes
              any_neighbor_province = {
                is_land = yes
                any_neighbor_province = {
                  region = custom_navarra
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_navarra
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_navarra = {
      save_event_target_as = first_duchy_title
    }
    k_navarra = {
      save_event_target_as = reconquista_kingdom_title
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
reconquista_balearic = {
  name = CB_NAME_RECONQUISTA_BALEARIC
  war_name = WAR_NAME_RECONQUISTA_BALEARIC
  diplo_view_region = custom_balearic
  sprite = 9
  truce_days = 3650
  is_permanent = yes
  is_holy_war = yes
  battle_warscore_mult = 0.5
  allow_whitepeace = no
  allowed_to_target_tributaries = yes
  can_ask_to_join_war = yes
  sort_priority = 10000
  can_use_gui = {
    ROOT = {
      prisoner = no
      is_adult = yes
    }
  }
  can_use = {
    ROOT = {
      has_character_flag = currently_reconquering_iberia
      not_reconquista_check_trigger = yes
      any_realm_province = {
        OR = {
          AND = {
            any_neighbor_province = {
              region = custom_balearic
            }
          }
          AND = {
            NOT = {
              any_neighbor_province = {
                region = custom_balearic
              }
            }
            NOT = {
              any_neighbor_province = {
                region = world_europe_west_iberia
                owner = {
                  OR = {
                    AND = {
                      independent = yes
                      NOT = {
                        religion_group = christian
                      }
                    }
                    top_liege = {
                      NOT = {
                        religion_group = christian
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              any_neighbor_province = {
                region = custom_balearic
              }
            }
          }
          AND = {
            NOR = {
              any_neighbor_province = {
                region = custom_balearic
              }
              any_neighbor_province = {
                any_neighbor_province = {
                  region = custom_balearic
                }
              }
            }
            NOT = {
              any_neighbor_province = {
                any_neighbor_province = {
                  region = world_europe_west_iberia
                  owner = {
                    OR = {
                      AND = {
                        independent = yes
                        NOT = {
                          religion_group = christian
                        }
                      }
                      top_liege = {
                        NOT = {
                          religion_group = christian
                        }
                      }
                    }
                  }
                }
              }
            }
            any_neighbor_province = {
              any_neighbor_province = {
                any_neighbor_province = {
                  region = custom_balearic
                }
              }
            }
          }
        }
      }
      conditional_tooltip = {
        trigger = {
          ai = yes
        }
        NOT = {
          has_character_modifier = reconquista_preparation_duration
        }
      }
    }
    FROM = {
      any_realm_province = {
        region = custom_balearic
      }
      NOT = {
        religion_group = ROOT
      }
    }
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = reconquista_valid_TT
        has_character_flag = currently_reconquering_iberia
      }
    }
    custom_tooltip = {
      text = reconquista_valid_2_TT
      FROM = {
        NOT = {
          religion_group = ROOT
        }
      }
    }
  }
  on_add = {
    custom_tooltip = {
      text = add_allies_reconquista_TT
    }
    ROOT = {
      character_event = {
        id = HF.49210
      }
    }
  }
  on_success = {
    d_mallorca = {
      save_event_target_as = first_duchy_title
    }
    reconquista_win_effect = yes
  }
  on_reverse_demand = {
    reconquista_lose_effect = yes
  }
  on_invalidation = {
    ROOT = {
      character_event = {
        id = HF.49200
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
thankmars_rebellion = {
  name = CB_NAME_THANKMARS_REBELLION
  war_name = WAR_NAME_THANKMARS_REBELLION
  diplo_view_region = world_europe_west_germania
  sprite = 12
  truce_days = 3650
  is_permanent = no
  allow_whitepeace = no
  allowed_to_target_tributaries = no
  can_ask_to_join_war = no
  major_revolt = yes
  can_call_allies = no
  can_use = {
    always = no
  }
  is_valid = {
    ROOT = {
      show_scope_change = no
      custom_tooltip = {
        text = THANKMAR_REBELLION_01_TT
        has_character_flag = is_thankmar
      }
    }
    FROM = {
      show_scope_change = no
      custom_tooltip = {
        text = THANKMAR_REBELLION_02_TT
        has_character_flag = is_otto
      }
    }
  }
  on_invalidation = {
    any_attacker = {
      set_defacto_liege = FROM
    }
    if = {
      limit = {
        ROOT = {
          is_alive = no
        }
        FROM = {
          is_alive = yes
        }
      }
      any_attacker = {
        imprison = ROOT
      }
    }
  }
  on_success = {
    custom_tooltip = {
      text = THANKMARS_REBELLION_VICTORY_TT
    }
    hidden_tooltip = {
      ROOT = {
        remove_trait = bastard
        dynasty = 669
        any_child = {
          limit = {
            NOT = {
              trait = bastard
            }
          }
          dynasty = 669
        }
      }
      FROM = {
        any_demesne_title = {
          grant_title_no_opinion = ROOT
        }
        imprison = ROOT
      }
      any_attacker = {
        set_defacto_liege = ROOT
      }
      ROOT = {
        narrative_event = {
          id = LT.40009
        }
      }
    }
  }
  on_reverse_demand = {
    FROM = {
      show_scope_change = no
      reverse_imprison = ROOT
      narrative_event = {
        id = LT.40011
      }
    }
    any_attacker = {
      show_scope_change = no
      imprison = FROM
    }
    hidden_tooltip = {
      any_attacker = {
        set_defacto_liege = FROM
      }
    }
  }
  attacker_ai_victory_worth = {
    factor = -1
  }
  attacker_ai_defeat_worth = {
    factor = 100
  }
  defender_ai_victory_worth = {
    factor = -1
  }
  defender_ai_defeat_worth = {
    factor = 100
  }
}
